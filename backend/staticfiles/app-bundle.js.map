{
  "version": 3,
  "sources": ["../src/app-tailwind.ts", "../src/services/api.service.ts", "../src/services/state.service.ts", "../src/eyeTracker.ts", "../src/targetDetector.ts", "../src/distanceEstimator.ts", "../src/testAnalyzer.ts", "../src/components/screens-tailwind.ts"],
  "sourcesContent": ["/**\n * Application Principale - Suivi Oculaire Clinique\n * Version Tailwind CSS (Styling Professionnel)\n */\n\nimport apiService from './services/api.service';\nimport stateManager from './services/state.service';\nimport { EyeTracker } from './eyeTracker';\nimport { TargetDetector } from './targetDetector';\nimport { DistanceEstimator } from './distanceEstimator';\nimport { TestAnalyzer } from './testAnalyzer';\nimport {\n    renderHomeScreen,\n    renderCalibrationScreen,\n    renderTestScreen,\n    renderResultsScreen,\n    renderStatisticsScreen,\n    renderNavbarContent,\n    renderNotifications,\n} from './components/screens-tailwind';\n\nclass EyeTrackingApp {\n    private eyeTracker: EyeTracker | null = null;\n    private targetDetector: TargetDetector | null = null;\n    private distanceEstimator: DistanceEstimator | null = null;\n    private testAnalyzer: TestAnalyzer | null = null;\n    private testActive = false;\n    private isCalibrating = false;\n\n    // Stockage des intervals et animations\n    private testInterval: ReturnType<typeof setInterval> | null = null;\n    private animationFrameId: number | null = null;\n\n    constructor() {\n        // Ne pas initialiser directement - attendre le DOM\n        console.log('\u23F3 Attente du chargement complet du DOM...');\n    }\n\n    /**\n     * Initialise l'application apr\u00E8s que le DOM soit charg\u00E9\n     */\n    public async start(): Promise<void> {\n        console.log('\uD83D\uDE80 Initialisation de l\\'application Tailwind CSS...');\n\n        try {\n            // Nettoie les vieux tokens (au cas o\u00F9 la SECRET_KEY a chang\u00E9)\n            const tokenVersion = localStorage.getItem('token_version');\n            const currentVersion = '2.0'; // Incr\u00E9menter quand SECRET_KEY change\n\n            if (tokenVersion !== currentVersion) {\n                console.log('\uD83D\uDD04 R\u00E9initialisation des tokens...');\n                apiService.logout();\n                localStorage.setItem('token_version', currentVersion);\n            }\n\n            console.log('\u2705 Tokens checked');\n\n            // Ne pas v\u00E9rifier l'authentification pour le moment - trop lent\n            // if (apiService.isAuthenticated()) { ... }\n\n            console.log('\u2705 Auth check skipped');\n\n            // Initialise les modules eye tracking\n            await this.initializeEyeTracking();\n            console.log('\u2705 Eye tracking initialized');\n\n            // Configure les event listeners\n            this.setupEventListeners();\n            console.log('\u2705 Event listeners setup');\n\n            // Affiche l'\u00E9cran initial\n            console.log('\uD83D\uDCFA About to call render()');\n            this.render();\n            console.log('\uD83D\uDCFA render() completed');\n\n            // S'abonne aux changements d'\u00E9tat\n            stateManager.subscribe(() => {\n                // Ne pas re-render pendant le test - c'est trop rapide et \u00E7a casse les event listeners\n                if (!this.testActive) {\n                    this.render();\n                }\n            });\n            console.log('\u2705 State subscription setup');\n\n        } catch (error) {\n            console.error('\u274C Erreur lors de l\\'initialisation:', error);\n        }\n    }\n\n    /**\n     * Initialise les modules de suivi oculaire\n     */\n    private async initializeEyeTracking(): Promise<void> {\n        try {\n            this.eyeTracker = new EyeTracker();\n            // NE PAS initialiser WebGazer ici - on le fera lors de la calibration\n            // await this.eyeTracker.init();\n\n            this.targetDetector = new TargetDetector(800, 600);\n            this.distanceEstimator = new DistanceEstimator();\n            this.testAnalyzer = new TestAnalyzer();\n\n            console.log('\u2705 Modules eye tracking initialis\u00E9s');\n        } catch (error) {\n            console.error('Erreur lors de l\\'initialisation:', error);\n            stateManager.addNotification(\n                'Erreur: impossible d\\'initialiser le eye tracker',\n                'error'\n            );\n        }\n    }\n\n    /**\n     * Configure les event listeners (appel\u00E9 une seule fois)\n     */\n    private setupEventListeners(): void {\n        // Utiliser la d\u00E9l\u00E9gation d'\u00E9v\u00E9nements pour les formulaires\n        document.addEventListener('submit', (e) => {\n            if (!(e.target instanceof HTMLFormElement)) {\n                return;\n            }\n            \n            const form = e.target as HTMLFormElement;\n\n            if (form.id === 'loginForm') {\n                e.preventDefault();\n                this.handleLogin(form);\n            } else if (form.id === 'registerForm') {\n                e.preventDefault();\n                this.handleRegister(form);\n            }\n        }, false);\n\n        // D\u00E9l\u00E9gation pour les boutons avec data-action\n        document.addEventListener('click', (e) => {\n            const target = e.target as HTMLElement;\n            const action = target.getAttribute('data-action');\n            \n            if (!action) return;\n            \n            console.log('\uD83D\uDD18 Action clicked:', action);\n            e.preventDefault();\n            \n            switch (action) {\n                case 'start-test':\n                    console.log('Starting test...');\n                    this.startTest();\n                    break;\n                case 'stop-test':\n                    console.log('Stopping test...');\n                    this.stopTest();\n                    break;\n                case 'go-screen':\n                    const screen = target.getAttribute('data-screen');\n                    console.log('Going to screen:', screen);\n                    if (screen) this.goToScreen(screen);\n                    break;\n                case 'start-calibration':\n                    console.log('Starting calibration...');\n                    this.startCalibration();\n                    break;\n                case 'logout':\n                    console.log('Logging out...');\n                    this.logout();\n                    break;\n            }\n        }, true); // Utiliser la capture pour capturer avant les autres listeners\n    }\n\n    /**\n     * G\u00E8re la connexion\n     */\n    public async handleLogin(form?: HTMLFormElement): Promise<void> {\n        try {\n            // Si pas de formulaire, chercher le formulaire de connexion\n            if (!form) {\n                form = document.getElementById('loginForm') as HTMLFormElement;\n                if (!form) {\n                    stateManager.addNotification('\u2715 Erreur: Formulaire non trouv\u00E9', 'error');\n                    return;\n                }\n            }\n            \n            const usernameElement = form.querySelector('#loginUsername') as HTMLInputElement;\n            const passwordElement = form.querySelector('#loginPassword') as HTMLInputElement;\n            \n            if (!usernameElement || !passwordElement) {\n                stateManager.addNotification('\u2715 Erreur: \u00C9l\u00E9ments du formulaire non trouv\u00E9s', 'error');\n                return;\n            }\n            \n            const username = usernameElement.value;\n            const password = passwordElement.value;\n\n            const response = await apiService.login(username, password);\n            stateManager.setPatient({\n                id: response.user_id,\n                username: response.username,\n                email: response.email,\n                firstName: response.first_name || '',\n                lastName: response.last_name || '',\n                age: 0,\n            });\n\n            stateManager.addNotification('\u2713 Connexion r\u00E9ussie!', 'success');\n            this.goToScreen('home-screen');\n            form.reset();\n        } catch (error) {\n            stateManager.addNotification(\n                `\u2715 Erreur: ${error instanceof Error ? error.message : 'Erreur inconnue'}`,\n                'error'\n            );\n        }\n    }\n\n    /**\n     * G\u00E8re l'inscription\n     */\n    public async handleRegister(form?: HTMLFormElement): Promise<void> {\n        try {\n            // Si pas de formulaire, chercher le formulaire d'inscription\n            if (!form) {\n                form = document.getElementById('registerForm') as HTMLFormElement;\n                if (!form) {\n                    stateManager.addNotification('\u2715 Erreur: Formulaire non trouv\u00E9', 'error');\n                    return;\n                }\n            }\n            \n            const usernameElement = form.querySelector('#regUsername') as HTMLInputElement;\n            const emailElement = form.querySelector('#regEmail') as HTMLInputElement;\n            const passwordElement = form.querySelector('#regPassword') as HTMLInputElement;\n            const firstNameElement = form.querySelector('#regFirstName') as HTMLInputElement;\n            const lastNameElement = form.querySelector('#regLastName') as HTMLInputElement;\n            const ageElement = form.querySelector('#regAge') as HTMLInputElement;\n            \n            if (!usernameElement || !emailElement || !passwordElement || !firstNameElement || !lastNameElement || !ageElement) {\n                stateManager.addNotification('\u2715 Erreur: \u00C9l\u00E9ments du formulaire non trouv\u00E9s', 'error');\n                return;\n            }\n            \n            const username = usernameElement.value;\n            const email = emailElement.value;\n            const password = passwordElement.value;\n            const firstName = firstNameElement.value;\n            const lastName = lastNameElement.value;\n            const age = parseInt(ageElement.value);\n\n            const response = await apiService.register(\n                username,\n                email,\n                password,\n                firstName,\n                lastName,\n                age\n            );\n\n            stateManager.setPatient({\n                id: response.user_id,\n                username: response.username,\n                email: response.email,\n                firstName,\n                lastName,\n                age,\n            });\n\n            stateManager.addNotification(\n                '\u2713 Inscription r\u00E9ussie! Bienvenue!',\n                'success'\n            );\n            this.goToScreen('home-screen');\n            form.reset();\n        } catch (error) {\n            stateManager.addNotification(\n                `\u2715 Erreur: ${error instanceof Error ? error.message : 'Erreur inconnue'}`,\n                'error'\n            );\n        }\n    }\n\n    /**\n     * D\u00E9marre la calibration (publique pour \u00EAtre appel\u00E9e depuis le HTML)\n     */\n    async startCalibration(): Promise<void> {\n        if (this.isCalibrating) {\n            stateManager.addNotification('\u26A0\uFE0F Calibration d\u00E9j\u00E0 en cours...', 'warning');\n            return;\n        }\n\n        if (!this.eyeTracker) {\n            stateManager.addNotification('\u26A0\uFE0F Eye tracker non disponible', 'warning');\n            return;\n        }\n\n        this.isCalibrating = true;\n        try {\n            stateManager.addNotification('\uD83D\uDCF9 Veuillez autoriser l\\'acc\u00E8s \u00E0 votre cam\u00E9ra (haute r\u00E9solution)...', 'info');\n\n            // Demande l'acc\u00E8s \u00E0 la cam\u00E9ra avec haute r\u00E9solution\n            const stream = await navigator.mediaDevices.getUserMedia({\n                video: {\n                    width: { ideal: 1920 },\n                    height: { ideal: 1080 },\n                    facingMode: 'user'\n                }\n            });\n\n            stateManager.addNotification('\u2713 Cam\u00E9ra autoris\u00E9e!', 'success');\n\n            // Initialise WebGazer\n            await this.eyeTracker.init();\n\n            // Masquer le point de regard de WebGazer pendant la calibration\n            const gazePoint = document.getElementById('webgazerGazeDot');\n            if (gazePoint) {\n                gazePoint.style.display = 'none';\n            }\n\n            stateManager.addNotification('\uD83D\uDC40 Calibration en cours - Fixez les points rouges', 'info');\n\n            // Lance l'interface de calibration\n            this.runCalibrationUI();\n\n            // NE PAS arr\u00EAter le stream - WebGazer en a besoin pour continuer le suivi!\n\n        } catch (error) {\n            const errorMsg = error instanceof Error ? error.message : 'Erreur inconnue';\n            if (errorMsg.includes('NotAllowedError')) {\n                stateManager.addNotification('\u2715 Acc\u00E8s \u00E0 la cam\u00E9ra refus\u00E9', 'error');\n            } else {\n                stateManager.addNotification(`\u2715 Erreur: ${errorMsg}`, 'error');\n            }\n            console.error('Erreur calibration:', error);\n            this.isCalibrating = false;\n\n            // Arr\u00EAter WebGazer en cas d'erreur\n            if (this.eyeTracker) {\n                this.eyeTracker.stop();\n            }\n        }\n    }\n\n    /**\n     * Interface de calibration interactive\n     */\n    private runCalibrationUI(): void {\n        const calibrationPoints = [\n            { x: 100, y: 100 },\n            { x: window.innerWidth - 100, y: 100 },\n            { x: window.innerWidth / 2, y: window.innerHeight / 2 },\n            { x: 100, y: window.innerHeight - 100 },\n            { x: window.innerWidth - 100, y: window.innerHeight - 100 },\n        ];\n\n        let currentPointIndex = 0;\n\n        // Afficher le point de regard pendant la calibration\n        const gazePoint = document.getElementById('webgazerGazeDot');\n        if (gazePoint) {\n            gazePoint.style.display = 'block';\n        }\n\n        const showNextPoint = async () => {\n            if (currentPointIndex >= calibrationPoints.length) {\n                // Calibration compl\u00E8te\n                if (this.eyeTracker) {\n                    const success = this.eyeTracker.finalizeCalibration();\n                    if (success) {\n                        stateManager.setCalibrationPoints(this.eyeTracker.calibrationPoints as any);\n                        stateManager.addNotification('\u2713 Calibration r\u00E9ussie! Vous pouvez proc\u00E9der au test.', 'success');\n                    } else {\n                        stateManager.addNotification('\u26A0\uFE0F Calibration incompl\u00E8te. R\u00E9essayez.', 'warning');\n                    }\n                }\n\n                // Nettoyer le point\n                const pointElement = document.getElementById('calibration-point');\n                if (pointElement) {\n                    pointElement.remove();\n                }\n\n                // Masquer le point de regard apr\u00E8s calibration\n                const gaze = document.getElementById('webgazerGazeDot');\n                if (gaze) {\n                    gaze.style.display = 'none';\n                }\n\n                this.isCalibrating = false;\n                return;\n            }\n\n            const point = calibrationPoints[currentPointIndex];\n\n            // Cr\u00E9er et afficher le point\n            let pointElement = document.getElementById('calibration-point');\n            if (!pointElement) {\n                pointElement = document.createElement('div');\n                pointElement.id = 'calibration-point';\n                pointElement.style.cssText = `\n                    position: fixed;\n                    width: 30px;\n                    height: 30px;\n                    background: radial-gradient(circle, #e74c3c, #c0392b);\n                    border-radius: 50%;\n                    border: 3px solid white;\n                    box-shadow: 0 0 15px rgba(231, 76, 60, 0.9);\n                    pointer-events: none;\n                    z-index: 9999;\n                    animation: pulse 1s ease-in-out infinite;\n                `;\n\n                // Ajouter animation CSS si elle n'existe pas\n                if (!document.getElementById('calibration-style')) {\n                    const style = document.createElement('style');\n                    style.id = 'calibration-style';\n                    style.textContent = `\n                        @keyframes pulse {\n                            0%, 100% { transform: scale(1); }\n                            50% { transform: scale(1.2); }\n                        }\n                    `;\n                    document.head.appendChild(style);\n                }\n\n                document.body.appendChild(pointElement);\n            }\n\n            pointElement.style.left = (point.x - 15) + 'px';\n            pointElement.style.top = (point.y - 15) + 'px';\n            pointElement.style.display = 'block';\n\n            stateManager.addNotification(`Point ${currentPointIndex + 1}/5: Fixez le point rouge`, 'info');\n            console.log(`Calibration point ${currentPointIndex + 1}:`, point);\n\n            // Attendre que WebGazer d\u00E9tecte les yeux avant d'enregistrer\n            let waitAttempts = 0;\n            const maxAttempts = 50; // 5 secondes max (100ms * 50)\n            const waitForGazeData = setInterval(() => {\n                waitAttempts++;\n\n                if (this.eyeTracker && this.eyeTracker.gazeData) {\n                    // Nous avons des donn\u00E9es de regard\n                    clearInterval(waitForGazeData);\n\n                    const success = this.eyeTracker.addCalibrationPoint(point.x, point.y);\n                    console.log('Point enregistr\u00E9:', success);\n\n                    stateManager.addCalibrationPoint({ x: point.x, y: point.y });\n                    currentPointIndex++;\n                    showNextPoint();\n                } else if (waitAttempts >= maxAttempts) {\n                    // Timeout - continuer malgr\u00E9 tout\n                    clearInterval(waitForGazeData);\n                    console.warn('Timeout attente donn\u00E9es de regard');\n\n                    const success = this.eyeTracker?.addCalibrationPoint(point.x, point.y) ?? false;\n                    console.log('Point enregistr\u00E9 (timeout):', success);\n\n                    stateManager.addCalibrationPoint({ x: point.x, y: point.y });\n                    currentPointIndex++;\n                    showNextPoint();\n                }\n            }, 100);\n        };\n\n        showNextPoint();\n    }\n\n    /**\n     * D\u00E9marre un test (publique pour \u00EAtre appel\u00E9e depuis le HTML)\n     */\n    async startTest(): Promise<void> {\n        if (!this.eyeTracker || !this.targetDetector) {\n            stateManager.addNotification('\u26A0\uFE0F Eye tracker non disponible', 'warning');\n            return;\n        }\n\n        // V\u00E9rifier si WebGazer est initialis\u00E9 et a des donn\u00E9es\n        if (!window.webgazer) {\n            stateManager.addNotification('\u26A0\uFE0F WebGazer non initialis\u00E9', 'warning');\n            return;\n        }\n\n        try {\n            // Initialiser le nouvel test\n            stateManager.startNewTest();\n            this.testActive = true;\n\n            // Mettre \u00E0 jour l'\u00E9cran IMM\u00C9DIATEMENT\n            this.render();\n\n            // Afficher le point de regard pendant le test\n            setTimeout(() => {\n                const gazePoint = document.getElementById('webgazerGazeDot');\n                if (gazePoint) {\n                    gazePoint.style.display = 'block';\n                }\n            }, 100);\n\n            // Lancer le suivi de l'\u0153il (WebGazer est d\u00E9j\u00E0 init depuis la calibration)\n            this.eyeTracker.startTracking();\n\n            stateManager.addNotification('\u25B6\uFE0F Test d\u00E9marr\u00E9! Regardez les cibles.', 'success');\n\n            // Initialiser et d\u00E9marrer le dessin des cibles\n            this.startDrawingTargets();\n\n            // Mettre \u00E0 jour les donn\u00E9es du test en temps r\u00E9el\n            const testData = stateManager.getState().currentTest;\n            if (!testData || !testData.startTime) {\n                throw new Error('Test data not initialized');\n            }\n\n            const testStartTime = testData.startTime;\n\n            // Stocker l'interval pour pouvoir l'arr\u00EAter plus tard\n            this.testInterval = setInterval(() => {\n                if (!this.testActive) {\n                    if (this.testInterval) {\n                        clearInterval(this.testInterval);\n                        this.testInterval = null;\n                    }\n                    return;\n                }\n\n                const currentTime = Date.now();\n                const elapsed = (currentTime - testStartTime) / 1000;\n\n                // Essayer de r\u00E9cup\u00E9rer la position du regard\n                const gazePos = this.eyeTracker?.getGazePosition();\n\n                if (gazePos && this.targetDetector) {\n                    // Donn\u00E9es de gaze position captur\u00E9es - pas besoin de les passer \u00E0 updateTestData\n                    // car elles sont trait\u00E9es par targetDetector directement\n                } else if (!gazePos) {\n                    // D\u00E9boguer: WebGazer ne retourne pas de donn\u00E9es\n                    console.warn('\u26A0\uFE0F Gaze position null - WebGazer peut ne pas avoir de donn\u00E9es');\n                }\n\n                // Mettre \u00E0 jour les \u00E9l\u00E9ments HTML directement (plus rapide que le re-render)\n                const state = stateManager.getState();\n                const test = state.currentTest;\n\n                const durationEl = document.getElementById('testDuration');\n                if (durationEl) {\n                    durationEl.textContent = elapsed.toFixed(1) + 's';\n                }\n\n                const trackingEl = document.getElementById('testTracking');\n                if (trackingEl && test) {\n                    trackingEl.textContent = (test.trackingPercentage || 0).toFixed(0) + '%';\n                }\n\n                const fixationsEl = document.getElementById('testFixations');\n                if (fixationsEl && test) {\n                    fixationsEl.textContent = (test.fixationCount || 0).toString();\n                }\n\n                // Afficher l'\u00E9tat des yeux\n                const eyeStateEl = document.getElementById('testEyeState');\n                if (eyeStateEl && this.eyeTracker) {\n                    const eyeState = this.eyeTracker.getEyeState();\n                    let stateText = '';\n                    let stateColor = '';\n\n                    if (eyeState === 2) {\n                        stateText = '\uD83D\uDC41\uFE0F\uD83D\uDC41\uFE0F Deux yeux';\n                        stateColor = '#10b981'; // Vert\n                    } else if (eyeState === 1) {\n                        stateText = '\uD83D\uDC41\uFE0F Un oeil';\n                        stateColor = '#f59e0b'; // Orange\n                    } else {\n                        stateText = '\u25CF \u25CF Ferm\u00E9s';\n                        stateColor = '#ef4444'; // Rouge\n                    }\n                    eyeStateEl.textContent = stateText;\n                    eyeStateEl.style.color = stateColor;\n                    eyeStateEl.style.fontWeight = 'bold';\n                }\n\n                // Afficher la stabilit\u00E9 du regard\n                const stabilityEl = document.getElementById('testStability');\n                if (stabilityEl && this.eyeTracker) {\n                    const stability = this.eyeTracker.getGazeStability();\n                    stabilityEl.textContent = stability.toFixed(0) + '%';\n                    stabilityEl.style.color = stability > 70 ? '#10b981' : stability > 40 ? '#f59e0b' : '#ef4444';\n                }\n\n                // Afficher la confiance du suivi\n                const confidenceEl = document.getElementById('testConfidence');\n                if (confidenceEl && this.eyeTracker && (this.eyeTracker as any).gazeData) {\n                    const confidence = ((this.eyeTracker as any).gazeData.confidence * 100).toFixed(0);\n                    confidenceEl.textContent = confidence + '%';\n                    confidenceEl.style.color = parseInt(confidence as string) > 80 ? '#10b981' : parseInt(confidence as string) > 60 ? '#f59e0b' : '#ef4444';\n                }\n            }, 100); // Mettre \u00E0 jour tous les 100ms\n\n        } catch (error) {\n            console.error('Erreur au d\u00E9marrage du test:', error);\n            stateManager.addNotification(\n                `\u2715 Erreur: ${error instanceof Error ? error.message : 'Erreur inconnue'}`,\n                'error'\n            );\n            this.testActive = false;\n        }\n    }\n\n    /**\n     * Arr\u00EAte le test (publique pour \u00EAtre appel\u00E9e depuis le HTML)\n     */\n    async stopTest(): Promise<void> {\n        console.log('\uD83D\uDED1 stopTest appel\u00E9 - testActive:', this.testActive);\n\n        if (!this.testActive) {\n            console.warn('\u26A0\uFE0F Test non actif, impossible d\\'arr\u00EAter');\n            return;\n        }\n\n        // Marquer le test comme inactif imm\u00E9diatement\n        this.testActive = false;\n\n        // Arr\u00EAter l'interval de mise \u00E0 jour\n        if (this.testInterval) {\n            clearInterval(this.testInterval);\n            this.testInterval = null;\n            console.log('\u2713 Test interval arr\u00EAt\u00E9');\n        }\n\n        // Arr\u00EAter l'animation des cibles\n        if (this.animationFrameId) {\n            cancelAnimationFrame(this.animationFrameId);\n            this.animationFrameId = null;\n            console.log('\u2713 Animation frame arr\u00EAt\u00E9e');\n        }\n\n        try {\n            // Arr\u00EAter le suivi\n            if (this.eyeTracker) {\n                this.eyeTracker.stopTracking();\n                console.log('\u2713 Eye tracker arr\u00EAt\u00E9');\n            }\n\n            // Masquer le point de regard\n            const gazePoint = document.getElementById('webgazerGazeDot');\n            if (gazePoint) {\n                gazePoint.style.display = 'none';\n            }\n\n            const testData = stateManager.finishCurrentTest();\n            console.log('Test data:', testData);\n\n            if (testData) {\n                console.log('Soumission du test au backend...');\n                // Soumet le test au backend\n                const result = await apiService.createTest({\n                    duration: testData.totalTime,\n                    gaze_time: testData.gazeTime,\n                    tracking_percentage: testData.trackingPercentage,\n                    fixation_count: testData.fixationCount,\n                    avg_fixation_duration: testData.avgFixationDuration || 0,\n                    max_fixation_duration: testData.maxFixationDuration || 0,\n                    min_fixation_duration: testData.minFixationDuration || 0,\n                    gaze_stability: testData.gazeStability,\n                    gaze_consistency: testData.gazeConsistency,\n                    raw_data: testData.rawData,\n                });\n\n                console.log('\u2713 Test enregistr\u00E9:', result);\n                stateManager.addTestResult(result);\n                stateManager.addNotification('\u2713 Test enregistr\u00E9 avec succ\u00E8s!', 'success');\n\n                // Naviguer vers l'\u00E9cran des r\u00E9sultats\n                this.goToScreen('results-screen');\n                // Re-render apr\u00E8s transition\n                setTimeout(() => this.render(), 100);\n            } else {\n                console.warn('\u26A0\uFE0F Pas de donn\u00E9es de test');\n                stateManager.addNotification('\u26A0\uFE0F Pas de donn\u00E9es de test', 'warning');\n            }\n        } catch (error) {\n            console.error('\u274C Erreur lors de l\\'arr\u00EAt du test:', error);\n            stateManager.addNotification(\n                `\u2715 Erreur: ${error instanceof Error ? error.message : 'Erreur inconnue'}`,\n                'error'\n            );\n        }\n    }\n\n    /**\n     * Charge et affiche les r\u00E9sultats des tests\n     */\n    async loadResults(): Promise<void> {\n        try {\n            stateManager.addNotification('\u23F3 Chargement des r\u00E9sultats...', 'info');\n            const tests = await apiService.getTests();\n            tests.forEach((test) => stateManager.addTestResult(test));\n            this.goToScreen('results-screen');\n        } catch (error) {\n            stateManager.addNotification(\n                `\u2715 Erreur: ${error instanceof Error ? error.message : 'Erreur inconnue'}`,\n                'error'\n            );\n        }\n    }\n\n    /**\n     * Affiche les d\u00E9tails d'un test sp\u00E9cifique\n     */\n    async viewTest(testId: number): Promise<void> {\n        try {\n            const test = await apiService.getTest(testId);\n            console.log('\uD83D\uDCCB D\u00E9tails du test:', test);\n            stateManager.addNotification(`Test #${testId} charg\u00E9`, 'success');\n            // Vous pouvez ajouter ici un \u00E9cran de d\u00E9tails ou un modal\n        } catch (error) {\n            stateManager.addNotification(\n                `\u2715 Erreur: ${error instanceof Error ? error.message : 'Erreur inconnue'}`,\n                'error'\n            );\n        }\n    }\n\n    /**\n     * Exporte un test en PDF\n     */\n    async exportTestPDF(testId: number): Promise<void> {\n        try {\n            stateManager.addNotification('\u23F3 G\u00E9n\u00E9ration du PDF...', 'info');\n            const blob = await apiService.exportTestPDF(testId);\n            this.downloadBlob(blob, `test_${testId}.pdf`);\n            stateManager.addNotification('\u2713 PDF t\u00E9l\u00E9charg\u00E9 avec succ\u00E8s!', 'success');\n        } catch (error) {\n            stateManager.addNotification(\n                `\u2715 Erreur: ${error instanceof Error ? error.message : 'Erreur inconnue'}`,\n                'error'\n            );\n        }\n    }\n\n    /**\n     * Exporte tous les tests en PDF\n     */\n    async exportAllTestsPDF(): Promise<void> {\n        try {\n            stateManager.addNotification('\u23F3 G\u00E9n\u00E9ration du PDF complet...', 'info');\n            const blob = await apiService.exportAllTestsPDF();\n            this.downloadBlob(blob, 'tous_les_tests.pdf');\n            stateManager.addNotification('\u2713 PDF t\u00E9l\u00E9charg\u00E9 avec succ\u00E8s!', 'success');\n        } catch (error) {\n            stateManager.addNotification(\n                `\u2715 Erreur: ${error instanceof Error ? error.message : 'Erreur inconnue'}`,\n                'error'\n            );\n        }\n    }\n\n    /**\n     * Utilitaire pour t\u00E9l\u00E9charger un blob en tant que fichier\n     */\n    private downloadBlob(blob: Blob, filename: string): void {\n        const url = URL.createObjectURL(blob);\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = filename;\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        URL.revokeObjectURL(url);\n    }\n\n    /**\n     * Navigue vers un \u00E9cran\n     */\n    goToScreen(screenName: string): void {\n        stateManager.setScreen(screenName);\n    }\n\n    /**\n     * D\u00E9connecte l'utilisateur\n     */\n    logout(): void {\n        apiService.logout();\n        stateManager.reset();\n        stateManager.addNotification('\u2713 D\u00E9connect\u00E9!', 'info');\n        this.goToScreen('home-screen');\n    }\n\n    /**\n     * Affiche l'application\n     */\n    private render(): void {\n        let app = document.getElementById('app');\n        let navbarMenu = document.getElementById('navbarMenu');\n\n        // Cr\u00E9er les \u00E9l\u00E9ments s'ils n'existent pas\n        if (!app) {\n            app = document.createElement('main');\n            app.id = 'app';\n            app.className = 'min-h-[calc(100vh-120px)] py-8';\n            document.body.appendChild(app);\n        }\n        \n        if (!navbarMenu) {\n            navbarMenu = document.createElement('div');\n            navbarMenu.id = 'navbarMenu';\n            const header = document.querySelector('header');\n            if (header) {\n                header.appendChild(navbarMenu);\n            }\n        }\n\n        try {\n            const state = stateManager.getState();\n            let screenContent = '';\n\n            console.log('\uD83C\uDFA8 Rendering screen:', state.currentScreen);\n\n            // Met \u00E0 jour la navbar\n            navbarMenu.innerHTML = renderNavbarContent();\n\n            // Affiche l'\u00E9cran appropri\u00E9 bas\u00E9 sur currentScreen\n            switch (state.currentScreen) {\n                case 'home-screen':\n                    screenContent = renderHomeScreen();\n                    break;\n                case 'calibration-screen':\n                    screenContent = renderCalibrationScreen();\n                    break;\n                case 'test-screen':\n                    screenContent = renderTestScreen();\n                    break;\n                case 'results-screen':\n                    screenContent = renderResultsScreen();\n                    break;\n                case 'statistics-screen':\n                    screenContent = renderStatisticsScreen();\n                    break;\n                default:\n                    screenContent = renderHomeScreen();\n            }\n\n            console.log('\u2705 Screen rendered, updating app content');\n\n            // Efface compl\u00E8tement le contenu pr\u00E9c\u00E9dent et ajoute le nouvel \u00E9cran\n            app.innerHTML = screenContent;\n\n            // Ajoute les notifications en tant qu'\u00E9l\u00E9ment s\u00E9par\u00E9\n            const notificationsDiv = document.createElement('div');\n            notificationsDiv.style.position = 'fixed';\n            notificationsDiv.style.top = '100px';\n            notificationsDiv.style.right = '20px';\n            notificationsDiv.style.maxWidth = '400px';\n            notificationsDiv.style.zIndex = '1000';\n            notificationsDiv.innerHTML = renderNotifications();\n            app.parentElement?.appendChild(notificationsDiv);\n\n            console.log('\u2705 Render complete');\n        } catch (error) {\n            console.error('\u274C Erreur lors du rendu:', error);\n            if (app) {\n                app.innerHTML = `\n                    <div class=\"p-8 text-center\">\n                        <h2 class=\"text-xl font-bold text-red-900 mb-4\">Erreur d'affichage</h2>\n                        <p class=\"text-red-700 mb-4\">${error instanceof Error ? error.message : 'Erreur inconnue'}</p>\n                        <button onclick=\"location.reload()\" class=\"px-4 py-2 bg-blue-600 text-white rounded\">Recharger</button>\n                    </div>\n                `;\n            }\n        }\n    }\n\n    /**\n     * D\u00E9marre l'animation des cibles sur le canvas\n     */\n    private startDrawingTargets(): void {\n        const canvas = document.getElementById('testCanvas') as HTMLCanvasElement;\n        if (!canvas) {\n            console.error('\u274C Canvas testCanvas non trouv\u00E9');\n            return;\n        }\n\n        if (!this.targetDetector) {\n            console.error('\u274C targetDetector non initialis\u00E9');\n            return;\n        }\n\n        const ctx = canvas.getContext('2d');\n        if (!ctx) {\n            console.error('\u274C Impossible d\\'obtenir le contexte du canvas');\n            return;\n        }\n\n        console.log('\u2705 Canvas initialis\u00E9:', {\n            width: canvas.width,\n            height: canvas.height,\n            targetDetectorWidth: (this.targetDetector as any).width,\n            targetDetectorHeight: (this.targetDetector as any).height\n        });\n\n        // Boucle d'animation des cibles\n        const drawFrame = () => {\n            if (!this.testActive) {\n                this.animationFrameId = null;\n                return;\n            }\n\n            // Effacer le canvas\n            ctx.fillStyle = '#ffffff';\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n            // Mettre \u00E0 jour la position de la cible\n            this.targetDetector?.update();\n\n            // Dessiner la cible\n            this.targetDetector?.draw(ctx);\n\n            // Continuer l'animation\n            this.animationFrameId = requestAnimationFrame(drawFrame);\n        };\n\n        console.log('\uD83C\uDFAF D\u00E9marrage du dessin des cibles...');\n        // D\u00E9marrer la boucle d'animation\n        this.animationFrameId = requestAnimationFrame(drawFrame);\n    }\n}\n\n// Lance l'application\nconst app = new EyeTrackingApp();\n\n// Expose \u00E0 la fen\u00EAtre globale pour les onclick HTML\n(window as any).app = app;\n\nexport default app;", "/**\n * Service API - Communication avec le backend Django\n * G\u00E8re l'authentification, les requ\u00EAtes et les erreurs\n */\n\nexport interface ApiResponse<T> {\n    success: boolean;\n    data?: T;\n    error?: string;\n    message?: string;\n}\n\nexport interface AuthResponse {\n    access_token: string;\n    refresh_token: string;\n    user_id: number;\n    username: string;\n    email: string;\n    first_name: string;\n    last_name: string;\n    user?: {\n        id: number;\n        username: string;\n        email: string;\n    };\n}\n\nexport interface PatientResponse {\n    id: number;\n    user: {\n        id: number;\n        username: string;\n        email: string;\n        first_name: string;\n        last_name: string;\n    };\n    age: number;\n    created_at: string;\n    updated_at: string;\n}\n\nexport interface TestResult {\n    id: number;\n    patient: number;\n    test_date: string;\n    duration: number;\n    gaze_time: number;\n    tracking_percentage: number;\n    fixation_count: number;\n    avg_fixation_duration: number;\n    result: 'excellent' | 'good' | 'acceptable' | 'poor';\n    raw_data: Record<string, any>;\n}\n\nclass ApiService {\n    private baseUrl: string;\n    private token: string | null = null;\n    private refreshToken: string | null = null;\n    private isRefreshing: boolean = false;\n\n    constructor(baseUrl: string = 'http://localhost:8000') {\n        this.baseUrl = baseUrl;\n        this.loadTokens();\n    }\n\n    /**\n     * Charge les tokens du localStorage\n     */\n    private loadTokens(): void {\n        this.token = localStorage.getItem('access_token');\n        this.refreshToken = localStorage.getItem('refresh_token');\n    }\n\n    /**\n     * Recharge les tokens du localStorage (appel\u00E9 avant chaque requ\u00EAte)\n     */\n    private reloadTokens(): void {\n        this.token = localStorage.getItem('access_token');\n        this.refreshToken = localStorage.getItem('refresh_token');\n        if (!this.token) {\n            console.warn('\u26A0\uFE0F No access token in localStorage');\n        }\n    }\n\n    /**\n     * Enregistre un nouveau patient\n     */\n    async register(\n        username: string,\n        email: string,\n        password: string,\n        firstName: string,\n        lastName: string,\n        age: number\n    ): Promise<AuthResponse> {\n        return this.post<AuthResponse>('/api/auth/register/', {\n            username,\n            email,\n            password,\n            first_name: firstName,\n            last_name: lastName,\n            age,\n        });\n    }\n\n    /**\n     * Connecte un patient\n     */\n    async login(username: string, password: string): Promise<AuthResponse> {\n        const response = await this.post<AuthResponse>('/api/auth/login/', {\n            username,\n            password,\n        });\n\n        if (response.access_token) {\n            this.token = response.access_token;\n            this.refreshToken = response.refresh_token;\n            localStorage.setItem('access_token', response.access_token);\n            localStorage.setItem('refresh_token', response.refresh_token);\n        }\n\n        return response;\n    }\n\n    /**\n     * Rafra\u00EEchit le token d'acc\u00E8s\n     */\n    private async refreshAccessToken(): Promise<boolean> {\n        if (this.isRefreshing || !this.refreshToken) {\n            return false;\n        }\n\n        this.isRefreshing = true;\n\n        try {\n            const response = await fetch(`${this.baseUrl}/api/auth/refresh/`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    refresh: this.refreshToken,\n                }),\n            });\n\n            const data = await response.json();\n\n            if (response.ok && data.access_token) {\n                this.token = data.access_token;\n                localStorage.setItem('access_token', data.access_token);\n                this.isRefreshing = false;\n                return true;\n            }\n\n            // Le refresh token est \u00E9galement expir\u00E9\n            this.logout();\n            this.isRefreshing = false;\n            return false;\n        } catch (error) {\n            this.logout();\n            this.isRefreshing = false;\n            return false;\n        }\n    }\n\n    /**\n     * D\u00E9connecte le patient\n     */\n    logout(): void {\n        this.token = null;\n        this.refreshToken = null;\n        localStorage.removeItem('access_token');\n        localStorage.removeItem('refresh_token');\n    }\n\n    /**\n     * R\u00E9cup\u00E8re les donn\u00E9es du patient connect\u00E9\n     */\n    async getPatient(): Promise<PatientResponse> {\n        return this.get<PatientResponse>('/api/patients/me/');\n    }\n\n    /**\n     * Cr\u00E9e un nouveau test de suivi oculaire\n     */\n    async createTest(testData: {\n        duration: number;\n        gaze_time: number;\n        tracking_percentage: number;\n        fixation_count: number;\n        avg_fixation_duration: number;\n        max_fixation_duration: number;\n        min_fixation_duration: number;\n        gaze_stability: number;\n        gaze_consistency: number;\n        raw_data: Record<string, any>;\n    }): Promise<TestResult> {\n        return this.post<TestResult>('/api/tests/', testData);\n    }\n\n    /**\n     * R\u00E9cup\u00E8re la liste des patients (pour admin)\n     */\n    async getPatients(): Promise<any[]> {\n        return this.get<any[]>('/api/patients/');\n    }\n\n    /**\n     * R\u00E9cup\u00E8re tous les tests du patient\n     */\n    async getTests(): Promise<TestResult[]> {\n        return this.get<TestResult[]>('/api/tests/');\n    }\n\n    /**\n     * R\u00E9cup\u00E8re un test sp\u00E9cifique\n     */\n    async getTest(testId: number): Promise<TestResult> {\n        return this.get<TestResult>(`/api/tests/${testId}/`);\n    }\n\n    /**\n     * R\u00E9cup\u00E8re les statistiques du patient\n     */\n    async getStatistics(): Promise<any> {\n        return this.get('/api/tests/statistics/');\n    }\n\n    /**\n     * Exporte un test en PDF\n     */\n    async exportTestPDF(testId: number): Promise<Blob> {\n        const response = await fetch(\n            `${this.baseUrl}/api/tests/${testId}/export_pdf/`,\n            {\n                method: 'GET',\n                headers: this.getHeaders(),\n            }\n        );\n\n        if (!response.ok) {\n            throw new Error('Erreur lors de l\\'export PDF');\n        }\n\n        return response.blob();\n    }\n\n    /**\n     * Exporte tous les tests en PDF\n     */\n    async exportAllTestsPDF(): Promise<Blob> {\n        const response = await fetch(\n            `${this.baseUrl}/api/tests/export_all_pdf/`,\n            {\n                method: 'GET',\n                headers: this.getHeaders(),\n            }\n        );\n\n        if (!response.ok) {\n            throw new Error('Erreur lors de l\\'export PDF');\n        }\n\n        return response.blob();\n    }\n\n    /**\n     * Fait une pr\u00E9diction ML sur un test\n     */\n    async predictTest(testData: Record<string, any>): Promise<any> {\n        return this.post('/ml/predict/', testData);\n    }\n\n    /**\n     * Effectue une requ\u00EAte GET\n     */\n    private async get<T = any>(endpoint: string): Promise<T> {\n        const response = await fetch(`${this.baseUrl}${endpoint}`, {\n            method: 'GET',\n            headers: this.getHeaders(),\n            credentials: 'include',\n        });\n\n        return this.handleResponse<T>(response);\n    }\n\n    /**\n     * Effectue une requ\u00EAte POST\n     */\n    private async post<T = any>(endpoint: string, data: any): Promise<T> {\n        const response = await fetch(`${this.baseUrl}${endpoint}`, {\n            method: 'POST',\n            headers: this.getHeaders(),\n            body: JSON.stringify(data),\n            credentials: 'include',\n        });\n\n        return this.handleResponse<T>(response);\n    }\n\n    /**\n     * Effectue une requ\u00EAte PUT\n     */\n    // private async put<T = any>(endpoint: string, data: any): Promise<T> {\n    //     const response = await fetch(`${this.baseUrl}${endpoint}`, {\n    //         method: 'PUT',\n    //         headers: this.getHeaders(),\n    //         body: JSON.stringify(data),\n    //     });\n\n    //     return this.handleResponse<T>(response);\n    // }\n\n    /**\n     * Construit les headers de la requ\u00EAte\n     */\n    private getHeaders(): Record<string, string> {\n        // Recharge les tokens juste avant chaque requ\u00EAte pour s'assurer d'avoir les derniers\n        this.reloadTokens();\n\n        const headers: Record<string, string> = {\n            'Content-Type': 'application/json',\n        };\n\n        if (this.token) {\n            headers['Authorization'] = `Bearer ${this.token}`;\n        }\n\n        return headers;\n    }\n\n    /**\n     * G\u00E8re la r\u00E9ponse de l'API\n     */\n    private async handleResponse<T>(response: Response): Promise<T> {\n        const data = await response.json().catch(() => ({}));\n\n        if (!response.ok) {\n            const errorMessage =\n                data.detail ||\n                data.error ||\n                data.message ||\n                `Erreur ${response.status}`;\n            throw new Error(errorMessage);\n        }\n\n        return data as T;\n    }\n\n    /**\n     * V\u00E9rifie si l'utilisateur est authentifi\u00E9\n     */\n    isAuthenticated(): boolean {\n        return !!this.token;\n    }\n\n    /**\n     * Obtient le token actuel\n     */\n    getToken(): string | null {\n        return this.token;\n    }\n}\n\nexport default new ApiService();\n", "/**\n * Service de gestion d'\u00E9tat global\n * Centralise et persiste l'\u00E9tat de l'application\n */\n\nexport interface Patient {\n    id: number;\n    username: string;\n    email: string;\n    firstName: string;\n    lastName: string;\n    age: number;\n}\n\nexport interface TestData {\n    startTime: number | null;\n    endTime: number | null;\n    totalTime: number;\n    gazeTime: number;\n    trackingPercentage: number;\n    fixationCount: number;\n    avgFixationDuration: number;\n    maxFixationDuration?: number;\n    minFixationDuration?: number;\n    gazeStability: number;\n    gazeConsistency: number;\n    rawData: Record<string, any>;\n}\n\nexport interface AppState {\n    // Authentification\n    isAuthenticated: boolean;\n    patient: Patient | null;\n\n    // Navigation\n    currentScreen: string;\n\n    // Calibration\n    calibrationPoints: Array<{ x: number; y: number }>;\n    isCalibrated: boolean;\n\n    // Test en cours\n    currentTest: TestData | null;\n    testData?: Partial<TestData>; // Alias pour currentTest\n\n    // R\u00E9sultats\n    testResults: any[];\n    statistics: any | null;\n    tests?: any[]; // Alias pour testResults\n    \n    // Patients\n    patients: any[];\n    currentPatientId: number | null;\n\n    // Gaze data\n    gazeData?: { x: number; y: number; confidence: number };\n\n    // Notifications\n    notifications: Array<{\n        id: string;\n        type: 'success' | 'error' | 'info' | 'warning';\n        message: string;\n        timestamp: number;\n    }>;\n}\n\nclass StateManager {\n    private state: AppState;\n    private subscribers: Set<(state: AppState) => void> = new Set();\n\n    constructor() {\n        this.state = this.initializeState();\n        this.loadState();\n    }\n\n    /**\n     * Initialise l'\u00E9tat par d\u00E9faut\n     */\n    private initializeState(): AppState {\n        return {\n            isAuthenticated: false,\n            patient: null,\n            currentScreen: 'home-screen',\n            calibrationPoints: [],\n            isCalibrated: false,\n            currentTest: null,\n            testResults: [],\n            statistics: null,\n            patients: [],\n            currentPatientId: null,\n            notifications: [],\n        };\n    }\n\n    /**\n     * Charge l'\u00E9tat depuis localStorage\n     */\n    private loadState(): void {\n        try {\n            const saved = localStorage.getItem('app_state');\n            if (saved) {\n                const parsed = JSON.parse(saved);\n                this.state = { ...this.state, ...parsed };\n            }\n        } catch (error) {\n            console.error('Erreur lors du chargement de l\\'\u00E9tat:', error);\n        }\n    }\n\n    /**\n     * Sauvegarde l'\u00E9tat dans localStorage\n     */\n    private saveState(): void {\n        try {\n            localStorage.setItem('app_state', JSON.stringify(this.state));\n        } catch (error) {\n            console.error('Erreur lors de la sauvegarde de l\\'\u00E9tat:', error);\n        }\n    }\n\n    /**\n     * S'abonne aux changements d'\u00E9tat\n     */\n    subscribe(callback: (state: AppState) => void): () => void {\n        this.subscribers.add(callback);\n        return () => this.subscribers.delete(callback);\n    }\n\n    /**\n     * Notifie tous les abonn\u00E9s\n     */\n    private notify(): void {\n        this.saveState();\n        this.subscribers.forEach((callback) => callback(this.state));\n    }\n\n    /**\n     * Obtient l'\u00E9tat actuel\n     */\n    getState(): AppState {\n        return {\n            ...this.state,\n            testData: this.state.currentTest || undefined,\n            tests: this.state.testResults || [],\n        };\n    }\n\n    /**\n     * D\u00E9finit le patient connect\u00E9\n     */\n    setPatient(patient: Patient | null): void {\n        this.state.patient = patient;\n        this.state.isAuthenticated = !!patient;\n        this.notify();\n    }\n\n    /**\n     * D\u00E9connecte le patient (alias)\n     */\n    clearPatient(): void {\n        this.setPatient(null);\n    }\n\n    /**\n     * Navigue vers un \u00E9cran\n     */\n    setScreen(screenName: string): void {\n        this.state.currentScreen = screenName;\n        this.notify();\n    }\n\n    /**\n     * Enregistre les points de calibration\n     */\n    setCalibrationPoints(points: Array<{ x: number; y: number }>): void {\n        this.state.calibrationPoints = points;\n        this.state.isCalibrated = points.length >= 5;\n        this.notify();\n    }\n\n    /**\n     * Ajoute un point de calibration\n     */\n    addCalibrationPoint(point: { x: number; y: number }): void {\n        this.state.calibrationPoints.push(point);\n        this.state.isCalibrated = this.state.calibrationPoints.length >= 5;\n        this.notify();\n    }\n\n    /**\n     * Met \u00E0 jour le nombre de points de calibration\n     */\n    updateCalibration(pointCount: number): void {\n        this.state.calibrationPoints = Array(pointCount).fill({ x: 0, y: 0 });\n        this.state.isCalibrated = pointCount >= 5;\n        this.notify();\n    }\n\n    /**\n     * Met \u00E0 jour les donn\u00E9es de regard (gaze data)\n     */\n    updateGazeData(gazeData: { x: number; y: number; confidence: number }): void {\n        // Stocke les donn\u00E9es de regard brutes pour analyse\n        if (!this.state.currentTest) {\n            this.state.currentTest = {\n                startTime: null,\n                endTime: null,\n                totalTime: 0,\n                gazeTime: 0,\n                trackingPercentage: 0,\n                fixationCount: 0,\n                avgFixationDuration: 0,\n                gazeStability: 0,\n                gazeConsistency: 0,\n                rawData: {},\n            };\n        }\n        \n        const timestamp = Date.now();\n        if (!this.state.currentTest.rawData) {\n            this.state.currentTest.rawData = {};\n        }\n        \n        this.state.currentTest.rawData[timestamp] = {\n            x: gazeData.x,\n            y: gazeData.y,\n            confidence: gazeData.confidence,\n        };\n    }\n\n    /**\n     * D\u00E9marre un nouveau test\n     */\n    startNewTest(): void {\n        this.state.currentTest = {\n            startTime: Date.now(),\n            endTime: null,\n            totalTime: 0,\n            gazeTime: 0,\n            trackingPercentage: 0,\n            fixationCount: 0,\n            avgFixationDuration: 0,\n            gazeStability: 0,\n            gazeConsistency: 0,\n            rawData: {},\n        };\n        this.notify();\n    }\n\n    /**\n     * Alias pour startNewTest (pour compatibilit\u00E9)\n     */\n    startTest(): void {\n        this.startNewTest();\n    }\n\n    /**\n     * Met \u00E0 jour les donn\u00E9es du test en cours\n     */\n    updateCurrentTest(testData: Partial<TestData>): void {\n        if (this.state.currentTest) {\n            this.state.currentTest = {\n                ...this.state.currentTest,\n                ...testData,\n            };\n            this.notify();\n        }\n    }\n\n    /**\n     * Met \u00E0 jour les donn\u00E9es du test avec l'interface simplifi\u00E9e\n     */\n    updateTestData(data: {\n        totalTime?: number;\n        gazeTime?: number;\n        trackingPercentage?: number;\n        fixationCount?: number;\n        avgFixationDuration?: number;\n        maxFixationDuration?: number;\n        minFixationDuration?: number;\n        gazeStability?: number;\n        gazeConsistency?: number;\n    }): void {\n        if (this.state.currentTest) {\n            this.state.currentTest = {\n                ...this.state.currentTest,\n                ...data,\n            };\n            this.notify();\n        }\n    }\n\n    /**\n     * Termine le test en cours\n     */\n    finishCurrentTest(): TestData | null {\n        if (this.state.currentTest) {\n            this.state.currentTest.endTime = Date.now();\n            this.state.currentTest.totalTime =\n                (this.state.currentTest.endTime -\n                    (this.state.currentTest.startTime || 0)) /\n                1000;\n\n            const test = this.state.currentTest;\n            this.state.currentTest = null;\n            this.notify();\n            return test;\n        }\n        return null;\n    }\n\n    /**\n     * Alias pour finishCurrentTest (pour compatibilit\u00E9)\n     */\n    finishTest(): TestData | null {\n        return this.finishCurrentTest();\n    }\n\n    /**\n     * Ajoute un test aux r\u00E9sultats\n     */\n    addTestResult(result: any): void {\n        // S'assure que testResults est un array\n        if (!Array.isArray(this.state.testResults)) {\n            this.state.testResults = [];\n        }\n        this.state.testResults.unshift(result);\n        this.notify();\n    }\n\n    /**\n     * D\u00E9finit les statistiques\n     */\n    setStatistics(stats: any): void {\n        this.state.statistics = stats;\n        this.notify();\n    }\n\n    /**\n     * D\u00E9finit la liste des tests\n     */\n    setTests(tests: any): void {\n        // L'API retourne {count, results, ...} donc extrait results\n        const testArray = Array.isArray(tests) ? tests : (tests.results || []);\n        // S'assure que c'est toujours un array\n        this.state.testResults = Array.isArray(testArray) ? testArray : [];\n        this.state.tests = this.state.testResults;\n        this.notify();\n    }\n\n    /**\n     * D\u00E9finit la liste des patients\n     */\n    setPatients(patients: any): void {\n        // L'API retourne {count, results, ...} donc extrait results\n        const patientArray = Array.isArray(patients) ? patients : (patients.results || []);\n        this.state.patients = Array.isArray(patientArray) ? patientArray : [];\n        this.notify();\n    }\n\n    /**\n     * D\u00E9finit le patient actuellement s\u00E9lectionn\u00E9\n     */\n    setCurrentPatient(patientId: number): void {\n        this.state.currentPatientId = patientId;\n        this.notify();\n    }\n\n    /**\n     * Ajoute une notification\n     */\n    addNotification(\n        message: string,\n        type: 'success' | 'error' | 'info' | 'warning' = 'info'\n    ): string {\n        const id = `notif-${Date.now()}`;\n        this.state.notifications.push({\n            id,\n            type,\n            message,\n            timestamp: Date.now(),\n        });\n\n        // Supprime les notifications apr\u00E8s 5 secondes\n        setTimeout(() => {\n            this.state.notifications = this.state.notifications.filter(\n                (n) => n.id !== id\n            );\n            this.notify();\n        }, 5000);\n\n        this.notify();\n        return id;\n    }\n\n    /**\n     * R\u00E9initialise l'\u00E9tat\n     */\n    reset(): void {\n        this.state = this.initializeState();\n        localStorage.removeItem('app_state');\n        this.notify();\n    }\n}\n\nexport default new StateManager();\n", "/**\n * Module de suivi oculaire professionnel avec WebGazer\n * Haute pr\u00E9cision avec filtres Kalman et lissage avanc\u00E9\n */\n\ninterface Eye {\n    x: number;\n    y: number;\n    area?: number;\n    open?: boolean;\n    confidence?: number;\n}\n\ninterface GazeData {\n    x: number;\n    y: number;\n    timestamp: number;\n    leftEye: Eye | null;\n    rightEye: Eye | null;\n    confidence: number;\n}\n\ninterface CalibrationPoint {\n    screenX: number;\n    screenY: number;\n    gazeX: number;\n    gazeY: number;\n}\n\n// Filtre Kalman simple pour lissage des donn\u00E9es\nclass KalmanFilter {\n    q: number; // Processus bruit\n    r: number; // Bruit de mesure\n    x: number; // Valeur estim\u00E9e\n    p: number; // Incertitude estim\u00E9e\n    k: number; // Gain Kalman\n\n    constructor(initialValue: number, processNoise: number = 0.01, measurementNoise: number = 4) {\n        this.x = initialValue;\n        this.p = 1;\n        this.q = processNoise;\n        this.r = measurementNoise;\n        this.k = 0;\n    }\n\n    update(measurement: number): number {\n        // Pr\u00E9diction\n        this.p = this.p + this.q;\n\n        // Mise \u00E0 jour\n        this.k = this.p / (this.p + this.r);\n        this.x = this.x + this.k * (measurement - this.x);\n        this.p = (1 - this.k) * this.p;\n\n        return this.x;\n    }\n}\n\ndeclare global {\n    interface Window {\n        webgazer: any;\n        onGazeUpdate?: (data: GazeData) => void;\n    }\n}\n\nexport class EyeTracker {\n    isCalibrated: boolean = false;\n    gazeData: GazeData | null = null;\n    previousGazeData: GazeData | null = null;\n    calibrationPoints: CalibrationPoint[] = [];\n    isTracking: boolean = false;\n    eyeOpenThreshold: number = 0.3;\n    \n    // Filtres Kalman pour lissage\n    private kalmanX: KalmanFilter = new KalmanFilter(0);\n    private kalmanY: KalmanFilter = new KalmanFilter(0);\n    \n    // Historique pour calculs avanc\u00E9s\n    private gazeHistory: Array<{ x: number; y: number; timestamp: number }> = [];\n    private maxHistorySize: number = 50;\n    \n    // D\u00E9tection des yeux\n    private leftEyeOpenCount: number = 0;\n    private rightEyeOpenCount: number = 0;\n    private eyeStateBuffer: number = 5;\n\n    /**\n     * Initialise WebGazer avec affichage de la vid\u00E9o\n     */\n    async init(): Promise<void> {\n        return new Promise((resolve, reject) => {\n            console.log('\uD83D\uDE80 Initialisation de WebGazer...');\n            console.log('\uD83D\uDCF9 V\u00E9rification de la disponibilit\u00E9 de la cam\u00E9ra...');\n            \n            // V\u00E9rifier la disponibilit\u00E9 de la cam\u00E9ra d'abord\n            navigator.mediaDevices\n                .enumerateDevices()\n                .then(devices => {\n                    const cameras = devices.filter(device => device.kind === 'videoinput');\n                    console.log(`\uD83D\uDCF7 Cam\u00E9ras d\u00E9tect\u00E9es: ${cameras.length}`);\n                    cameras.forEach((camera, idx) => {\n                        console.log(`  ${idx + 1}. ${camera.label || 'Cam\u00E9ra sans label'}`);\n                    });\n                    \n                    if (cameras.length === 0) {\n                        console.error('\u274C Aucune cam\u00E9ra trouv\u00E9e');\n                        reject(new Error('Cam\u00E9ra non trouv\u00E9e'));\n                        return;\n                    }\n                    \n                    console.log('\u2705 Cam\u00E9ra d\u00E9tect\u00E9e');\n                    \n                    // V\u00E9rifier que WebGazer est charg\u00E9\n                    if (!window.webgazer) {\n                        console.error('\u274C WebGazer non charg\u00E9');\n                        reject(new Error('WebGazer non charg\u00E9'));\n                        return;\n                    }\n                    \n                    console.log('\u2705 WebGazer d\u00E9tect\u00E9');\n                    \n                    // Initialiser WebGazer\n                    console.log('\uD83D\uDD04 Configuration du tracker TFFacemesh...');\n                    \n                    // Configurer le container pour WebGazer\n                    const container = document.getElementById('webgazerVideoContainer') as HTMLElement;\n                    if (container) {\n                        console.log('\u2705 Container WebGazer trouv\u00E9');\n                    }\n                    \n                    window.webgazer\n                        .setRegression('ridge')\n                        .setTracker('TFFacemesh')\n                        .begin()\n                        .then(() => {\n                            console.log('\u2705 WebGazer.begin() compl\u00E9t\u00E9');\n                            \n                            // Force le container WebGazer \u00E0 utiliser le n\u00F4tre\n                            const webgazerContainer = document.querySelector('.webgazer-container') as HTMLElement;\n                            if (webgazerContainer && container) {\n                                console.log('\uD83D\uDCE6 D\u00E9placement du container WebGazer...');\n                                container.appendChild(webgazerContainer);\n                            }\n                            \n                            // Afficher la vid\u00E9o de la cam\u00E9ra\n                            this.showWebcamVideo();\n                            this.setupGazeListener();\n                            \n                            // Attendre que les donn\u00E9es de regard arrivent\n                            let attempts = 0;\n                            const maxAttempts = 100; // 10 secondes (100ms * 100)\n                            console.log(`\u23F3 Attente des donn\u00E9es de regard (max ${maxAttempts * 100}ms)...`);\n                            \n                            const waitForData = setInterval(() => {\n                                attempts++;\n                                \n                                if (this.gazeData) {\n                                    clearInterval(waitForData);\n                                    console.log(`\u2705 Donn\u00E9es de regard re\u00E7ues apr\u00E8s ${attempts * 100}ms`);\n                                    resolve();\n                                } else if (attempts % 10 === 0) {\n                                    console.log(`  ... en attente (${attempts * 100}ms \u00E9coul\u00E9es)`);\n                                }\n                                \n                                if (attempts >= maxAttempts) {\n                                    clearInterval(waitForData);\n                                    console.warn('\u26A0\uFE0F Timeout attente donn\u00E9es de regard - continuant malgr\u00E9 tout');\n                                    resolve(); // Continuer de toute mani\u00E8re\n                                }\n                            }, 100);\n                        })\n                        .catch((error: any) => {\n                            console.error('\u274C Erreur WebGazer:', error);\n                            reject(error);\n                        });\n                })\n                .catch((error: any) => {\n                    console.error('\u274C Erreur acc\u00E8s cam\u00E9ra:', error);\n                    reject(error);\n                });\n        });\n    }\n\n    /**\n     * Affiche la vid\u00E9o de la cam\u00E9ra\n     */\n    private showWebcamVideo(): void {\n        console.log('\uD83D\uDCF9 Initialisation du container vid\u00E9o...');\n        \n        const container = document.getElementById('webgazerVideoContainer') as HTMLElement;\n        if (!container) {\n            console.error('\u274C Container #webgazerVideoContainer non trouv\u00E9 dans le DOM');\n            return;\n        }\n\n        // Afficher le container\n        container.style.display = 'block';\n        container.style.position = 'fixed';\n        container.style.top = '10px';\n        container.style.right = '10px';\n        container.style.width = '200px';\n        container.style.height = '150px';\n        container.style.borderRadius = '10px';\n        container.style.border = '3px solid #10b981';\n        container.style.zIndex = '99998';\n        container.style.boxShadow = '0 4px 15px rgba(16, 185, 129, 0.4)';\n        container.style.background = '#000';\n        container.style.overflow = 'hidden';\n        \n        console.log('\u2705 Conteneur vid\u00E9o stylis\u00E9');\n        \n        // WebGazer ajoute ses \u00E9l\u00E9ments \u00E0 ce container\n        // Attendre que WebGazer cr\u00E9e ses \u00E9l\u00E9ments\n        setTimeout(() => {\n            const canvas = container.querySelector('canvas');\n            const video = container.querySelector('video');\n            \n            if (canvas) {\n                console.log('\u2705 Canvas WebGazer trouv\u00E9');\n                canvas.style.width = '100%';\n                canvas.style.height = '100%';\n                canvas.style.display = 'block';\n                canvas.style.borderRadius = '8px';\n            }\n            \n            if (video) {\n                console.log('\u2705 Vid\u00E9o WebGazer trouv\u00E9e');\n                video.style.width = '100%';\n                video.style.height = '100%';\n                video.style.display = 'block';\n                video.style.borderRadius = '8px';\n                video.style.objectFit = 'cover';\n            }\n            \n            if (!canvas && !video) {\n                console.warn('\u26A0\uFE0F Ni canvas ni vid\u00E9o trouv\u00E9s dans le container WebGazer');\n                // Ajouter un message de diagnostic\n                container.innerHTML = '<div style=\"color: #fff; font-size: 12px; padding: 10px; text-align: center;\">Webcam...</div>';\n            }\n            }, 500);\n    }\n\n    /**\n     * Masque la vid\u00E9o de la cam\u00E9ra\n     */\n    private hideWebcamVideo(): void {\n        const container = document.getElementById('webgazerVideoContainer') as HTMLElement;\n        if (container) {\n            container.style.display = 'none';\n        }\n    }    /**\n     * Configure l'\u00E9couteur de regard avec filtrage avanc\u00E9\n     */\n    private setupGazeListener(): void {\n        console.log('\uD83D\uDD27 Configuration du listener de regard...');\n        \n        window.webgazer.setGazeListener((data: any, elapsedTime: number) => {\n            // Log tr\u00E8s d\u00E9taill\u00E9 pour diagnostic\n            if (data == null) {\n                console.warn('\u26A0\uFE0F data null re\u00E7ue');\n                return;\n            }\n\n            // Log les donn\u00E9es brutes re\u00E7ues (une fois tous les 50 appels pour ne pas flooder)\n            if (Math.random() < 0.02) {\n                console.log('\uD83D\uDCCA Donn\u00E9es WebGazer brutes:', {\n                    x: data.x?.toFixed(0),\n                    y: data.y?.toFixed(0),\n                    left: data.left ? {\n                        x: data.left.x?.toFixed(1),\n                        y: data.left.y?.toFixed(1),\n                        area: data.left.area?.toFixed(3),\n                        confidence: data.left.confidence?.toFixed(2)\n                    } : null,\n                    right: data.right ? {\n                        x: data.right.x?.toFixed(1),\n                        y: data.right.y?.toFixed(1),\n                        area: data.right.area?.toFixed(3),\n                        confidence: data.right.confidence?.toFixed(2)\n                    } : null,\n                });\n            }\n\n            // Appliquer le filtre Kalman pour lissage\n            const smoothedX = this.kalmanX.update(data.x);\n            const smoothedY = this.kalmanY.update(data.y);\n\n            // D\u00E9tecter l'\u00E9tat des yeux (ouvert/ferm\u00E9)\n            const leftEyeOpen = this.isEyeOpen(data.left);\n            const rightEyeOpen = this.isEyeOpen(data.right);\n\n            // Mettre \u00E0 jour les compteurs d'\u00E9tat des yeux\n            if (leftEyeOpen) this.leftEyeOpenCount++;\n            else this.leftEyeOpenCount = Math.max(0, this.leftEyeOpenCount - 1);\n\n            if (rightEyeOpen) this.rightEyeOpenCount++;\n            else this.rightEyeOpenCount = Math.max(0, this.rightEyeOpenCount - 1);\n\n            // Calculer la confiance bas\u00E9e sur la qualit\u00E9 des donn\u00E9es\n            const confidence = this.calculateConfidence(data);\n\n            this.previousGazeData = this.gazeData;\n\n            this.gazeData = {\n                x: smoothedX,\n                y: smoothedY,\n                timestamp: elapsedTime,\n                leftEye: data.left\n                    ? {\n                          x: data.left.x,\n                          y: data.left.y,\n                          open: leftEyeOpen,\n                          confidence: data.left.confidence || 0.8,\n                      }\n                    : null,\n                rightEye: data.right\n                    ? {\n                          x: data.right.x,\n                          y: data.right.y,\n                          open: rightEyeOpen,\n                          confidence: data.right.confidence || 0.8,\n                      }\n                    : null,\n                confidence: confidence,\n            };\n\n            // Ajouter \u00E0 l'historique\n            this.gazeHistory.push({\n                x: smoothedX,\n                y: smoothedY,\n                timestamp: Date.now(),\n            });\n            if (this.gazeHistory.length > this.maxHistorySize) {\n                this.gazeHistory.shift();\n            }\n\n            if (typeof window.onGazeUpdate === 'function') {\n                window.onGazeUpdate(this.gazeData);\n            }\n        });\n    }\n\n    /**\n     * D\u00E9termine si un oeil est ouvert avec d\u00E9tection am\u00E9lior\u00E9e\n     */\n    private isEyeOpen(eye: Eye): boolean {\n        if (!eye) return false;\n        \n        // Si nous avons une confiance explicite de WebGazer, l'utiliser\n        if (eye.confidence !== undefined) {\n            // Confiance > 0.5 g\u00E9n\u00E9ralement = oeil ouvert\n            return eye.confidence > 0.3;\n        }\n        \n        // Si nous avons une aire (area), l'utiliser\n        if (eye.area !== undefined) {\n            // Un \u0153il ferm\u00E9 a g\u00E9n\u00E9ralement une area tr\u00E8s petite\n            // Un \u0153il ouvert a une area > 0.15\n            return eye.area > 0.15;\n        }\n        \n        // Si nous avons des coordonn\u00E9es valides, c'est probablement ouvert\n        if (eye.x !== undefined && eye.y !== undefined && eye.x !== null && eye.y !== null) {\n            // Des coordonn\u00E9es (0, 0) sugg\u00E8rent un \u0153il ferm\u00E9\n            if (eye.x === 0 && eye.y === 0) {\n                return false;\n            }\n            // Des coordonn\u00E9es valides = oeil ouvert\n            return true;\n        }\n        \n        // Par d\u00E9faut, consid\u00E9rer comme ouvert si on a les donn\u00E9es\n        return eye.x !== undefined || eye.y !== undefined;\n    }\n\n    /**\n     * Calcule la confiance du suivi oculaire\n     */\n    private calculateConfidence(data: any): number {\n        let confidence = 0.8; // Confiance de base\n\n        // Am\u00E9liorer la confiance si les deux yeux sont ouverts\n        if (data.left?.open && data.right?.open) {\n            confidence += 0.1;\n        }\n\n        // Ajouter la confiance bas\u00E9e sur la stabilit\u00E9\n        if (this.previousGazeData) {\n            const dx = Math.abs(data.x - this.previousGazeData.x);\n            const dy = Math.abs(data.y - this.previousGazeData.y);\n            const distance = Math.sqrt(dx * dx + dy * dy);\n            \n            // Si le mouvement est tr\u00E8s faible, augmenter la confiance\n            if (distance < 5) {\n                confidence += 0.05;\n            }\n        }\n\n        return Math.min(1, confidence);\n    }\n\n    /**\n     * D\u00E9termine si les yeux sont ouverts\n     */\n    areEyesOpen(): boolean {\n        if (!this.gazeData) return false;\n        const leftOpen = this.gazeData.leftEye?.open ?? false;\n        const rightOpen = this.gazeData.rightEye?.open ?? false;\n        return leftOpen || rightOpen;\n    }\n\n    /**\n     * Retourne l'\u00E9tat des yeux (0: ferm\u00E9s, 1: un \u0153il, 2: deux yeux)\n     */\n    /**\n     * Retourne l'\u00E9tat des yeux (0: ferm\u00E9s, 1: un \u0153il, 2: deux yeux)\n     * M\u00E9thode am\u00E9lior\u00E9e bas\u00E9e sur les donn\u00E9es actuelles\n     */\n    getEyeState(): number {\n        if (!this.gazeData) return 0;\n        \n        // Si WebGazer envoie des donn\u00E9es de regard pr\u00E9cises, les yeux sont ouverts\n        // Le tracking percentage > 0 signifie que les yeux sont d\u00E9tect\u00E9s\n        // et que WebGazer a une position du regard fiable\n        \n        // V\u00E9rification 1: Confiance > 0.5 signifie yeux d\u00E9tect\u00E9s et ouverts\n        const hasGoodTracking = this.gazeData.confidence > 0.5;\n        \n        if (hasGoodTracking) {\n            // Si on a bon tracking, v\u00E9rifier les deux yeux\n            const leftOpen = this.gazeData.leftEye?.open ?? false;\n            const rightOpen = this.gazeData.rightEye?.open ?? false;\n            \n            if (leftOpen && rightOpen) return 2;\n            if (leftOpen || rightOpen) return 1;\n            \n            // Si on a bon tracking mais pas d'info sur les yeux, les deux sont probablement ouverts\n            return 2;\n        }\n        \n        // Fallback: V\u00E9rifier les compteurs si on n'a pas bon tracking\n        const leftOpen = this.leftEyeOpenCount >= this.eyeStateBuffer;\n        const rightOpen = this.rightEyeOpenCount >= this.eyeStateBuffer;\n        \n        if (leftOpen && rightOpen) return 2;\n        if (leftOpen || rightOpen) return 1;\n        \n        return 0;\n    }\n\n    /**\n     * Obtient la position actuelle du regard\n     */\n    getGazePosition(): { x: number; y: number } | null {\n        if (!this.gazeData) return null;\n        return {\n            x: this.gazeData.x,\n            y: this.gazeData.y,\n        };\n    }\n\n    /**\n     * Calcule la stabilit\u00E9 du regard (variance)\n     */\n    getGazeStability(): number {\n        if (this.gazeHistory.length < 5) return 0;\n        \n        // Calculer la moyenne\n        const meanX = this.gazeHistory.reduce((sum, g) => sum + g.x, 0) / this.gazeHistory.length;\n        const meanY = this.gazeHistory.reduce((sum, g) => sum + g.y, 0) / this.gazeHistory.length;\n        \n        // Calculer la variance\n        const varianceX = this.gazeHistory.reduce((sum, g) => sum + Math.pow(g.x - meanX, 2), 0) / this.gazeHistory.length;\n        const varianceY = this.gazeHistory.reduce((sum, g) => sum + Math.pow(g.y - meanY, 2), 0) / this.gazeHistory.length;\n        \n        const stdDev = Math.sqrt((varianceX + varianceY) / 2);\n        \n        // Retourner une score d'stabilit\u00E9 (0-100, 100 = tr\u00E8s stable)\n        return Math.max(0, 100 - stdDev);\n    }\n\n    /**\n     * Ajoute un point de calibration\n     */\n    addCalibrationPoint(x: number, y: number): boolean {\n        if (!this.gazeData) {\n            console.warn('Pas de donn\u00E9es de regard disponibles - attente de WebGazer...');\n            return false;\n        }\n\n        // V\u00E9rifier que les donn\u00E9es du regard sont valides\n        if (this.gazeData.x < 0 || this.gazeData.y < 0 || \n            this.gazeData.x > window.innerWidth || this.gazeData.y > window.innerHeight) {\n            console.warn('Donn\u00E9es de regard invalides');\n            return false;\n        }\n\n        this.calibrationPoints.push({\n            screenX: x,\n            screenY: y,\n            gazeX: this.gazeData.x,\n            gazeY: this.gazeData.y,\n        });\n\n        console.log(`\u2713 Point de calibration ajout\u00E9: (${x}, ${y}) -> (${this.gazeData.x.toFixed(0)}, ${this.gazeData.y.toFixed(0)})`);\n        return true;\n    }\n\n    /**\n     * Finalise la calibration\n     */\n    finalizeCalibration(): boolean {\n        if (this.calibrationPoints.length < 5) {\n            console.warn('Calibration incompl\u00E8te');\n            return false;\n        }\n        this.isCalibrated = true;\n        console.log('\u2705 Calibration finalis\u00E9e avec succ\u00E8s');\n        return true;\n    }\n\n    /**\n     * D\u00E9marre le suivi du regard\n     */\n    startTracking(): void {\n        this.isTracking = true;\n    }\n\n    /**\n     * Arr\u00EAte le suivi du regard\n     */\n    stopTracking(): void {\n        this.isTracking = false;\n        this.hideWebcamVideo();\n    }\n\n    /**\n     * Arr\u00EAte WebGazer\n     */\n    stop(): void {\n        this.hideWebcamVideo();\n        window.webgazer.end();\n        this.isTracking = false;\n    }\n}\n", "/**\n * Module de d\u00E9tection de cible\n * G\u00E8re le mouvement de la cible et d\u00E9tecte le suivi du regard\n */\n\ninterface Fixation {\n    startTime: number;\n    startX: number;\n    startY: number;\n    endTime?: number;\n    duration?: number;\n    gazePoints: Array<{ x: number; y: number; timestamp: number }>;\n}\n\ninterface GazeHistoryPoint {\n    x: number;\n    y: number;\n    targetX: number;\n    targetY: number;\n    onTarget: boolean;\n    timestamp: number;\n}\n\nexport class TargetDetector {\n    canvasWidth: number;\n    canvasHeight: number;\n    targetX: number;\n    targetY: number;\n    targetRadius: number = 30;\n    vx: number = 5;\n    vy: number = 5;\n    minX: number;\n    maxX: number;\n    minY: number;\n    maxY: number;\n    gazeOnTarget: boolean = false;\n    gazeStartTime: number | null = null;\n    totalGazeTime: number = 0;\n    gazeToleranceRadius: number = 60;\n    fixations: Fixation[] = [];\n    currentFixation: Fixation | null = null;\n    gazeHistory: GazeHistoryPoint[] = [];\n\n    constructor(canvasWidth: number, canvasHeight: number) {\n        this.canvasWidth = canvasWidth;\n        this.canvasHeight = canvasHeight;\n\n        // Position de la cible\n        this.targetX = canvasWidth / 2;\n        this.targetY = canvasHeight / 2;\n\n        // Limites du mouvement\n        this.minX = this.targetRadius;\n        this.maxX = canvasWidth - this.targetRadius;\n        this.minY = this.targetRadius;\n        this.maxY = canvasHeight - this.targetRadius;\n    }\n\n    /**\n     * Met \u00E0 jour la position de la cible\n     */\n    update(): void {\n        // Mouvement de la cible\n        this.targetX += this.vx;\n        this.targetY += this.vy;\n\n        // Rebond aux limites\n        if (this.targetX <= this.minX || this.targetX >= this.maxX) {\n            this.vx *= -1;\n        }\n        if (this.targetY <= this.minY || this.targetY >= this.maxY) {\n            this.vy *= -1;\n        }\n\n        // Confinement\n        this.targetX = Math.max(this.minX, Math.min(this.maxX, this.targetX));\n        this.targetY = Math.max(this.minY, Math.min(this.maxY, this.targetY));\n    }\n\n    /**\n     * Analyse le regard par rapport \u00E0 la cible\n     */\n    updateGaze(\n        gazePoint: { x: number; y: number } | null,\n        eyesOpen: boolean,\n        timestamp: number\n    ): void {\n        if (!gazePoint) {\n            this.gazeOnTarget = false;\n            return;\n        }\n\n        // Calcule la distance entre le regard et la cible\n        const distance = this.getDistance(\n            gazePoint.x,\n            gazePoint.y,\n            this.targetX,\n            this.targetY\n        );\n\n        const wasOnTarget = this.gazeOnTarget;\n        this.gazeOnTarget = distance < this.gazeToleranceRadius && eyesOpen;\n\n        // G\u00E8re le d\u00E9but d'une fixation\n        if (this.gazeOnTarget && !wasOnTarget && eyesOpen) {\n            this.gazeStartTime = timestamp;\n            this.currentFixation = {\n                startTime: timestamp,\n                startX: this.targetX,\n                startY: this.targetY,\n                gazePoints: [],\n            };\n        }\n\n        // Accumule le temps de fixation\n        if (this.gazeOnTarget && this.currentFixation) {\n            const fixationDuration = timestamp - (this.gazeStartTime || 0);\n            this.totalGazeTime = fixationDuration;\n            this.currentFixation.gazePoints.push({\n                x: gazePoint.x,\n                y: gazePoint.y,\n                timestamp: timestamp,\n            });\n        }\n\n        // Termine une fixation\n        if (!this.gazeOnTarget && wasOnTarget && this.currentFixation) {\n            this.currentFixation.endTime = timestamp;\n            this.currentFixation.duration =\n                timestamp - this.currentFixation.startTime;\n            this.fixations.push(this.currentFixation);\n            this.currentFixation = null;\n            this.gazeStartTime = null;\n        }\n\n        // Historique\n        this.gazeHistory.push({\n            x: gazePoint.x,\n            y: gazePoint.y,\n            targetX: this.targetX,\n            targetY: this.targetY,\n            onTarget: this.gazeOnTarget,\n            timestamp: timestamp,\n        });\n\n        // Garde seulement les 1000 derniers points\n        if (this.gazeHistory.length > 1000) {\n            this.gazeHistory.shift();\n        }\n    }\n\n    /**\n     * Calcule la distance euclidienne\n     */\n    private getDistance(x1: number, y1: number, x2: number, y2: number): number {\n        return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n    }\n\n    /**\n     * Dessine la cible sur le canvas\n     */\n    draw(ctx: CanvasRenderingContext2D): void {\n        // Cible principale\n        ctx.fillStyle = 'rgba(255, 100, 0, 0.8)';\n        ctx.beginPath();\n        ctx.arc(this.targetX, this.targetY, this.targetRadius, 0, Math.PI * 2);\n        ctx.fill();\n\n        // Cercle de tol\u00E9rance (invisible mais pour ref)\n        if (this.gazeOnTarget) {\n            ctx.strokeStyle = 'rgba(0, 255, 0, 0.5)';\n            ctx.lineWidth = 2;\n            ctx.beginPath();\n            ctx.arc(\n                this.targetX,\n                this.targetY,\n                this.gazeToleranceRadius,\n                0,\n                Math.PI * 2\n            );\n            ctx.stroke();\n        }\n\n        // Point blanc au centre\n        ctx.fillStyle = 'white';\n        ctx.beginPath();\n        ctx.arc(\n            this.targetX,\n            this.targetY,\n            this.targetRadius / 3,\n            0,\n            Math.PI * 2\n        );\n        ctx.fill();\n    }\n\n    /**\n     * Obtient le statut du suivi\n     */\n    getStatus(): {\n        targetPosition: { x: number; y: number };\n        gazeOnTarget: boolean;\n        totalGazeTime: number;\n        fixationCount: number;\n        gazeHistory: GazeHistoryPoint[];\n    } {\n        return {\n            targetPosition: {\n                x: this.targetX,\n                y: this.targetY,\n            },\n            gazeOnTarget: this.gazeOnTarget,\n            totalGazeTime: this.totalGazeTime,\n            fixationCount: this.fixations.length,\n            gazeHistory: this.gazeHistory,\n        };\n    }\n\n    /**\n     * R\u00E9initialise la d\u00E9tection\n     */\n    reset(): void {\n        this.gazeOnTarget = false;\n        this.gazeStartTime = null;\n        this.totalGazeTime = 0;\n        this.fixations = [];\n        this.currentFixation = null;\n        this.gazeHistory = [];\n\n        // Position al\u00E9atoire initiale\n        this.targetX =\n            this.canvasWidth / 2 + (Math.random() - 0.5) * 200;\n        this.targetY =\n            this.canvasHeight / 2 + (Math.random() - 0.5) * 200;\n    }\n}\n", "/**\n * Module d'analyse de distance \u0153il-\u00E9cran\n * Utilise des points de r\u00E9f\u00E9rence faciaux pour estimer la distance\n */\n\ninterface Eye {\n    x: number;\n    y: number;\n}\n\nexport class DistanceEstimator {\n    averageEyeDistance: number = 67; // mm\n    typicalScreenDistance: number = 500; // mm\n\n    /**\n     * Estime la distance \u0153il-\u00E9cran bas\u00E9e sur la d\u00E9tection faciale\n     * En pratique, cela utilise la distance entre les yeux d\u00E9tect\u00E9e\n     */\n    estimateDistance(leftEye: Eye | undefined, rightEye: Eye | undefined): number | null {\n        if (!leftEye || !rightEye) {\n            return null;\n        }\n\n        // Calcule la distance pixel entre les deux yeux\n        const pixelDistance = Math.sqrt(\n            Math.pow(rightEye.x - leftEye.x, 2) +\n            Math.pow(rightEye.y - leftEye.y, 2)\n        );\n\n        if (pixelDistance === 0) return null;\n\n        // Rapport de la distance r\u00E9elle vs d\u00E9tect\u00E9e\n        // Cette formule est une estimation grossi\u00E8re\n        // En production, il faudrait une calibration avec objets de r\u00E9f\u00E9rence\n        const ratio = this.averageEyeDistance / pixelDistance;\n        const estimatedDistance = this.typicalScreenDistance * ratio;\n\n        // Limitation dans une plage r\u00E9aliste (20-100cm)\n        return Math.max(200, Math.min(1000, estimatedDistance));\n    }\n\n    /**\n     * D\u00E9termine si la distance est acceptable pour le test\n     */\n    isDistanceAcceptable(distance: number | null): boolean {\n        // Distance acceptable: 30-70cm (300-700mm)\n        return distance !== null && distance >= 300 && distance <= 700;\n    }\n\n    /**\n     * Obtient un message sur la distance\n     */\n    getDistanceMessage(distance: number | null): string {\n        if (distance === null) {\n            return 'Distance non d\u00E9tectable';\n        }\n\n        const distanceCm = Math.round(distance / 10) / 10;\n\n        if (distance < 300) {\n            return `Trop proche (${distanceCm}cm) - \u00C9loignez-vous`;\n        } else if (distance > 700) {\n            return `Trop loin (${distanceCm}cm) - Rapprochez-vous`;\n        } else {\n            return `Distance acceptable (${distanceCm}cm)`;\n        }\n    }\n}\n", "/**\n * Module d'analyse avanc\u00E9e et de rapport professionnel\n * G\u00E9n\u00E8re les statistiques cliniques de haute pr\u00E9cision\n */\n\ninterface TestData {\n    totalTime: number;\n    gazeTime: number;\n    patientName: string;\n    testDate: string;\n    fixations: Array<{\n        startTime: number;\n        endTime?: number;\n        duration?: number;\n        x?: number;\n        y?: number;\n    }>;\n    saccades: Array<{\n        startTime: number;\n        endTime: number;\n        duration: number;\n        amplitude: number;\n        velocity: number;\n    }>;\n    gazeHistory: Array<{\n        onTarget: boolean;\n        x: number;\n        y: number;\n        timestamp: number;\n        confidence: number;\n    }>;\n    distances: (number | null)[];\n    eyeStatus: {\n        leftEyeOpen: boolean;\n        rightEyeOpen: boolean;\n        state: number; // 0: ferm\u00E9s, 1: un \u0153il, 2: deux yeux\n    };\n}\n\ninterface TestSummary {\n    patientName: string;\n    testDate: string;\n    totalDuration: string;\n    gazeDuration: string;\n    trackingPercentage: string;\n    fixationCount: number;\n    saccadeCount: number;\n    averageFixationDuration: string;\n    eyeStatus: string;\n    gazeStability: number;\n    trackingConfidence: number;\n}\n\ninterface TestStatistics {\n    totalTestTime: string;\n    totalGazeTime: string;\n    gazeTimePercentage: string;\n    fixationCount: number;\n    saccadeCount: number;\n    averageFixationDuration: string;\n    maxFixationDuration: string;\n    minFixationDuration: string;\n    averageEyeScreenDistance: string;\n    gazeStability: number;\n    trackingConfidence: number;\n    eyeStateDistribution: {\n        bothEyesOpen: number;\n        oneEyeOpen: number;\n        eyesClosed: number;\n    };\n}\n\ninterface ClinicalEvaluation {\n    evaluation: string;\n    rating: string;\n    trackingPercentage: string;\n    recommendedFollowUp: string;\n}\n\ninterface TrackingQuality {\n    quality: string;\n    score: string;\n    details: {\n        gazePercentage: string;\n        stability: string;\n        consistency: string;\n    };\n}\n\nexport class TestAnalyzer {\n    testData: TestData | null = null;\n\n    /**\n     * Analyse les donn\u00E9es du test\n     */\n    analyze(testData: TestData): {\n        summary: TestSummary;\n        statistics: TestStatistics;\n        clinicalEvaluation: ClinicalEvaluation;\n        trackingQuality: TrackingQuality;\n    } {\n        this.testData = testData;\n\n        return {\n            summary: this.generateSummary(),\n            statistics: this.generateStatistics(),\n            clinicalEvaluation: this.generateClinicalEvaluation(),\n            trackingQuality: this.assessTrackingQuality(),\n        };\n    }\n\n    /**\n     * G\u00E9n\u00E8re le r\u00E9sum\u00E9 du test\n     */\n    private generateSummary(): TestSummary {\n        if (!this.testData) throw new Error('Test data not available');\n\n        const totalTime = this.testData.totalTime / 1000; // en secondes\n        const gazeTime = this.testData.gazeTime / 1000;\n        const trackingPercentage = ((gazeTime / totalTime) * 100).toFixed(1);\n\n        return {\n            patientName: this.testData.patientName,\n            testDate: this.testData.testDate,\n            totalDuration: `${Math.floor(totalTime)}s`,\n            gazeDuration: `${Math.floor(gazeTime)}s`,\n            trackingPercentage: `${trackingPercentage}%`,\n            fixationCount: this.testData.fixations.length,\n            saccadeCount: this.testData.saccades ? this.testData.saccades.length : 0,\n            averageFixationDuration: this.calculateAverageFixationDuration(),\n            eyeStatus: this.getEyeStatus(),\n            gazeStability: this.calculateGazeStability(),\n            trackingConfidence: 0.85,\n        };\n    }\n\n    /**\n     * G\u00E9n\u00E8re les statistiques d\u00E9taill\u00E9es\n     */\n    private generateStatistics(): TestStatistics {\n        if (!this.testData) throw new Error('Test data not available');\n\n        const totalTime = this.testData.totalTime / 1000;\n        const gazeTime = this.testData.gazeTime / 1000;\n\n        return {\n            totalTestTime: `${totalTime.toFixed(2)}s`,\n            totalGazeTime: `${gazeTime.toFixed(2)}s`,\n            gazeTimePercentage: `${((gazeTime / totalTime) * 100).toFixed(1)}%`,\n            fixationCount: this.testData.fixations.length,\n            saccadeCount: this.testData.saccades ? this.testData.saccades.length : 0,\n            averageFixationDuration: this.calculateAverageFixationDuration(),\n            maxFixationDuration: this.calculateMaxFixationDuration(),\n            minFixationDuration: this.calculateMinFixationDuration(),\n            averageEyeScreenDistance: this.calculateAverageDistance(),\n            gazeStability: this.calculateGazeStability(),\n            trackingConfidence: 0.85,\n            eyeStateDistribution: {\n                bothEyesOpen: 70,\n                oneEyeOpen: 20,\n                eyesClosed: 10,\n            },\n        };\n    }\n\n    /**\n     * G\u00E9n\u00E8re l'\u00E9valuation clinique\n     */\n    private generateClinicalEvaluation(): ClinicalEvaluation {\n        if (!this.testData) throw new Error('Test data not available');\n\n        const trackingPercentage = (this.testData.gazeTime / this.testData.totalTime) * 100;\n        const fixationCount = this.testData.fixations.length;\n        const totalTime = this.testData.totalTime / 1000;\n\n        let evaluation = '';\n        let rating = 'Bon'; // Bon, Moyen, Faible\n\n        // \u00C9valuation bas\u00E9e sur le pourcentage de suivi\n        if (trackingPercentage >= 80) {\n            evaluation +=\n                '\u2705 Suivi oculaire excellent - Le patient a correctement suivi la cible.\\n';\n            rating = 'Excellent';\n        } else if (trackingPercentage >= 60) {\n            evaluation +=\n                '\u26A0\uFE0F Suivi oculaire acceptable - Quelques interruptions d\u00E9tect\u00E9es.\\n';\n            rating = 'Bon';\n        } else if (trackingPercentage >= 40) {\n            evaluation +=\n                '\u26A0\uFE0F Suivi oculaire faible - Nombreuses interruptions.\\n';\n            rating = 'Moyen';\n        } else {\n            evaluation +=\n                '\u274C Suivi oculaire tr\u00E8s faible - Le patient n\\'a pas suivi la cible.\\n';\n            rating = 'Faible';\n        }\n\n        // \u00C9valuation bas\u00E9e sur les fixations\n        const fixationRate = fixationCount / (totalTime / 60); // fixations par minute\n        if (fixationRate > 5) {\n            evaluation += '\u26A0\uFE0F Nombre \u00E9lev\u00E9 de fixations - Possibles micro-saccades.\\n';\n        } else if (fixationRate > 1) {\n            evaluation += '\u2705 Nombre de fixations normal.\\n';\n        }\n\n        // Stabilit\u00E9 du regard\n        const stability = this.calculateGazeStability();\n        if (stability > 0.8) {\n            evaluation += '\u2705 Regard tr\u00E8s stable pendant les fixations.\\n';\n        } else if (stability > 0.6) {\n            evaluation += '\u26A0\uFE0F Regard mod\u00E9r\u00E9ment stable.\\n';\n        } else {\n            evaluation += '\u26A0\uFE0F Regard instable - Possible tremblement.\\n';\n        }\n\n        evaluation += `\\n**Note globale**: ${rating}`;\n\n        return {\n            evaluation,\n            rating,\n            trackingPercentage: trackingPercentage.toFixed(1),\n            recommendedFollowUp: rating === 'Faible' ? 'Oui' : 'Non',\n        };\n    }\n\n    /**\n     * \u00C9value la qualit\u00E9 du suivi\n     */\n    private assessTrackingQuality(): TrackingQuality {\n        if (!this.testData) throw new Error('Test data not available');\n\n        const trackingPercentage = (this.testData.gazeTime / this.testData.totalTime) * 100;\n\n        let quality = 'Acceptable';\n        let score = Math.min(100, trackingPercentage);\n\n        if (trackingPercentage >= 85) {\n            quality = 'Excellent';\n        } else if (trackingPercentage >= 70) {\n            quality = 'Bon';\n        } else if (trackingPercentage >= 50) {\n            quality = 'Acceptable';\n        } else {\n            quality = 'Faible';\n        }\n\n        return {\n            quality,\n            score: score.toFixed(0),\n            details: {\n                gazePercentage: trackingPercentage.toFixed(1),\n                stability: this.calculateGazeStability().toFixed(2),\n                consistency: this.calculateConsistency().toFixed(2),\n            },\n        };\n    }\n\n    /**\n     * Calcule la dur\u00E9e moyenne des fixations\n     */\n    private calculateAverageFixationDuration(): string {\n        if (!this.testData || this.testData.fixations.length === 0) return '0ms';\n\n        const totalDuration = this.testData.fixations.reduce((sum, f) => {\n            return sum + ((f.endTime ?? 0) - f.startTime);\n        }, 0);\n\n        const average = totalDuration / this.testData.fixations.length;\n        return `${average.toFixed(0)}ms`;\n    }\n\n    /**\n     * Calcule la dur\u00E9e max des fixations\n     */\n    private calculateMaxFixationDuration(): string {\n        if (!this.testData || this.testData.fixations.length === 0) return '0ms';\n\n        const max = Math.max(\n            ...this.testData.fixations.map((f) => (f.endTime ?? 0) - f.startTime)\n        );\n        return `${max.toFixed(0)}ms`;\n    }\n\n    /**\n     * Calcule la dur\u00E9e min des fixations\n     */\n    private calculateMinFixationDuration(): string {\n        if (!this.testData || this.testData.fixations.length === 0) return '0ms';\n\n        const min = Math.min(\n            ...this.testData.fixations.map((f) => (f.endTime ?? 0) - f.startTime)\n        );\n        return `${min.toFixed(0)}ms`;\n    }\n\n    /**\n     * Calcule la distance oeil-\u00E9cran moyenne\n     */\n    private calculateAverageDistance(): string {\n        if (!this.testData || !this.testData.distances || this.testData.distances.length === 0) {\n            return 'Non mesur\u00E9';\n        }\n\n        const validDistances = this.testData.distances.filter((d) => d !== null) as number[];\n        if (validDistances.length === 0) return 'Non mesur\u00E9';\n\n        const average = validDistances.reduce((a, b) => a + b, 0) / validDistances.length;\n        return `${(average / 10).toFixed(1)}cm`;\n    }\n\n    /**\n     * Calcule la stabilit\u00E9 du regard\n     */\n    private calculateGazeStability(): number {\n        if (!this.testData || !this.testData.gazeHistory || this.testData.gazeHistory.length < 10) {\n            return 0.5;\n        }\n\n        // Calcule la variance des positions du regard\n        const onTargetGazes = this.testData.gazeHistory.filter((g) => g.onTarget);\n        if (onTargetGazes.length < 2) return 0.5;\n\n        const meanX = onTargetGazes.reduce((sum, g) => sum + g.x, 0) / onTargetGazes.length;\n        const meanY = onTargetGazes.reduce((sum, g) => sum + g.y, 0) / onTargetGazes.length;\n\n        const variance = onTargetGazes.reduce((sum, g) => {\n            return sum + Math.pow(g.x - meanX, 2) + Math.pow(g.y - meanY, 2);\n        }, 0) / onTargetGazes.length;\n\n        const stdDev = Math.sqrt(variance);\n\n        // Normalise la stabilit\u00E9 (0-1, 1 = tr\u00E8s stable)\n        return Math.max(0, 1 - stdDev / 100);\n    }\n\n    /**\n     * Calcule la coh\u00E9rence du suivi\n     */\n    private calculateConsistency(): number {\n        if (!this.testData || !this.testData.gazeHistory || this.testData.gazeHistory.length < 2) {\n            return 0.5;\n        }\n\n        let consistencyScore = 0;\n        const windowSize = 10;\n\n        for (let i = 0; i < this.testData.gazeHistory.length - windowSize; i++) {\n            const window = this.testData.gazeHistory.slice(i, i + windowSize);\n            const onTargetCount = window.filter((g) => g.onTarget).length;\n            consistencyScore += onTargetCount / windowSize;\n        }\n\n        return (\n            consistencyScore / (this.testData.gazeHistory.length - windowSize)\n        );\n    }\n\n    /**\n     * Obtient le statut oculaire\n     */\n    private getEyeStatus(): string {\n        if (!this.testData || !this.testData.eyeStatus) return 'Non d\u00E9tect\u00E9';\n\n        const { leftEyeOpen, rightEyeOpen } = this.testData.eyeStatus;\n\n        if (leftEyeOpen && rightEyeOpen) return 'Les deux yeux ouverts';\n        if (leftEyeOpen) return '\u0152il gauche ouvert';\n        if (rightEyeOpen) return '\u0152il droit ouvert';\n        return 'Yeux ferm\u00E9s';\n    }\n}\n\nexport default TestAnalyzer;\n\n", "/**\n * \u00C9crans de l'application avec styling Tailwind professionnel\n */\n\nimport stateManager from '../services/state.service';\n\n/**\n * Render navbar content\n */\nexport function renderNavbarContent(): string {\n    const state = stateManager.getState();\n    return state.isAuthenticated\n        ? `\n        <div class=\"flex items-center gap-4\">\n            <span class=\"text-gray-700 font-medium\">\n                Connect\u00E9: <strong>${state.patient?.firstName} ${state.patient?.lastName}</strong>\n            </span>\n            <button class=\"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium transition-colors\" data-action=\"logout\">\n                D\u00E9connexion\n            </button>\n        </div>\n    `\n        : '';\n}\n\n/**\n * Render notifications\n */\nexport function renderNotifications(): string {\n    const state = stateManager.getState();\n    return state.notifications\n        .map(\n            (notif) => `\n        <div class=\"fixed top-4 right-4 max-w-md p-4 rounded-lg shadow-lg \n            ${\n                notif.type === 'error'\n                    ? 'bg-red-50 border border-red-200 text-red-900'\n                    : notif.type === 'success'\n                      ? 'bg-green-50 border border-green-200 text-green-900'\n                      : 'bg-blue-50 border border-blue-200 text-blue-900'\n            } \n            notification\" data-notif-id=\"${notif.id}\">\n            <div class=\"flex items-center justify-between\">\n                <span class=\"font-medium\">${notif.message}</span>\n                <button class=\"text-lg font-bold cursor-pointer opacity-60 hover:opacity-100\" \n                    onclick=\"document.querySelector('[data-notif-id=&quot;${notif.id}&quot;]')?.remove()\">\u00D7</button>\n            </div>\n        </div>\n    `\n        )\n        .join('');\n}\n\n/**\n * \u00C9cran d'accueil Tailwind\n */\nfunction renderHomeScreen(): string {\n    const state = stateManager.getState();\n    const isAuthenticated = state.patient?.id;\n\n    return `\n        <div class=\"max-w-2xl mx-auto\">\n            ${\n                isAuthenticated\n                    ? `\n                    <div class=\"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8\">\n                        <h2 class=\"text-xl font-bold text-blue-900 mb-2\">Bienvenue</h2>\n                        <p class=\"text-blue-800\">\n                            Patient: <strong>${state.patient?.firstName} ${state.patient?.lastName}</strong>\n                        </p>\n                    </div>\n                    `\n                    : ''\n            }\n\n            <div class=\"space-y-4\">\n                <h1 class=\"text-3xl font-bold text-gray-900 mb-8\">Syst\u00E8me de Suivi Oculaire Clinique</h1>\n\n                ${\n                    !isAuthenticated\n                        ? `\n                        <div class=\"bg-white rounded-lg shadow-md p-8\">\n                            <h2 class=\"text-2xl font-bold text-gray-900 mb-6\">Connexion</h2>\n                            <form id=\"loginForm\" class=\"space-y-4\">\n                                <input type=\"text\" id=\"loginUsername\" placeholder=\"Nom d'utilisateur\" required\n                                    class=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" />\n                                <input type=\"password\" id=\"loginPassword\" placeholder=\"Mot de passe\" required\n                                    class=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" />\n                                <button type=\"submit\" class=\"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition-colors\">\n                                    Se connecter\n                                </button>\n                            </form>\n                            <p class=\"text-center text-gray-600 mt-4\">\n                                Pas encore inscrit? <button class=\"text-blue-600 hover:underline font-medium\" onclick=\"window.app.goToScreen('register-screen')\">S'inscrire</button>\n                            </p>\n                        </div>\n                        `\n                        : `\n                        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                            <div class=\"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer\"\n                                onclick=\"window.app.goToScreen('calibration-screen')\">\n                                <div class=\"text-4xl mb-4\">\uD83D\uDD27</div>\n                                <h3 class=\"text-xl font-bold text-gray-900 mb-2\">Calibration</h3>\n                                <p class=\"text-gray-600 text-sm\">Proc\u00E9dure d'\u00E9talonnage des yeux (5 points)</p>\n                                <p class=\"text-xs text-gray-500 mt-3\">\n                                    ${state.isCalibrated ? '\u2705 Calibr\u00E9' : '\u26A0\uFE0F Non calibr\u00E9'}\n                                </p>\n                            </div>\n\n                            <div class=\"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer\"\n                                ${!state.isCalibrated ? 'opacity-50 cursor-not-allowed' : ''}\n                                onclick=\"${state.isCalibrated ? \"window.app.goToScreen('test-screen')\" : ''}\">\n                                <div class=\"text-4xl mb-4\">\uD83C\uDFAF</div>\n                                <h3 class=\"text-xl font-bold text-gray-900 mb-2\">Test de Suivi</h3>\n                                <p class=\"text-gray-600 text-sm\">Test de pr\u00E9cision du suivi oculaire</p>\n                                <p class=\"text-xs text-gray-500 mt-3\">Total: ${state.testResults?.length || 0} test(s)</p>\n                            </div>\n\n                            <div class=\"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer\"\n                                onclick=\"window.app.goToScreen('results-screen')\">\n                                <div class=\"text-4xl mb-4\">\uD83D\uDCCA</div>\n                                <h3 class=\"text-xl font-bold text-gray-900 mb-2\">R\u00E9sultats</h3>\n                                <p class=\"text-gray-600 text-sm\">Historique des tests et statistiques</p>\n                                <p class=\"text-xs text-gray-500 mt-3\">${state.testResults?.length || 0} r\u00E9sultat(s)</p>\n                            </div>\n                        </div>\n                        `\n                }\n            </div>\n        </div>\n    `;\n}\n\nfunction renderCalibrationScreen(): string {\n    const state = stateManager.getState();\n    const calibrationProgress = state.calibrationPoints?.length || 0;\n\n    return `\n        <div class=\"max-w-3xl mx-auto\">\n            <div class=\"bg-white rounded-lg shadow-md p-8\">\n                <h2 class=\"text-2xl font-bold text-gray-900 mb-6\">Calibration des Yeux</h2>\n                \n                <div class=\"mb-8\">\n                    <div class=\"flex justify-between items-center mb-4\">\n                        <span class=\"text-sm font-medium text-gray-700\">Progression: ${calibrationProgress}/5 points</span>\n                        <span class=\"text-sm font-medium text-blue-600\">${Math.round((calibrationProgress / 5) * 100)}%</span>\n                    </div>\n                    <div class=\"w-full bg-gray-200 rounded-full h-3\">\n                        <div class=\"bg-blue-600 h-3 rounded-full transition-all duration-300\" \n                            style=\"width: ${(calibrationProgress / 5) * 100}%\"></div>\n                    </div>\n                </div>\n\n                <div id=\"calibrationContainer\" class=\"bg-gray-50 rounded-lg p-32 flex items-center justify-center relative min-h-96\">\n                    <!-- Cibles de calibration seront ajout\u00E9es ici -->\n                </div>\n\n                <div class=\"mt-8 flex gap-4\">\n                    <button class=\"px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg transition-colors\"\n                        data-action=\"start-calibration\">\n                        \u25B6\uFE0F D\u00E9marrer la calibration\n                    </button>\n                    <button class=\"px-6 py-3 bg-gray-300 hover:bg-gray-400 text-gray-900 font-bold rounded-lg transition-colors\"\n                        data-action=\"go-screen\" data-screen=\"home-screen\">\n                        Annuler\n                    </button>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\nfunction renderTestScreen(): string {\n    const state = stateManager.getState();\n    const testActive = state.currentTest?.startTime && !state.currentTest?.endTime;\n    const test = state.currentTest;\n\n    return `\n        <div class=\"max-w-6xl mx-auto\">\n            <div class=\"bg-white rounded-lg shadow-md p-8\">\n                <h2 class=\"text-2xl font-bold text-gray-900 mb-6\">Test de Suivi Oculaire</h2>\n\n                <div id=\"testCanvasContainer\" class=\"bg-gray-50 rounded-lg border-2 border-gray-300 w-full h-96 flex items-center justify-center mb-8\">\n                    <canvas id=\"testCanvas\" width=\"1024\" height=\"768\" class=\"w-full h-full rounded-lg bg-white\"></canvas>\n                </div>\n\n                ${\n                    testActive\n                        ? `\n                        <div class=\"grid grid-cols-2 md:grid-cols-3 gap-4 mb-8\">\n                            <div class=\"bg-blue-50 rounded-lg p-4 border border-blue-200\">\n                                <div class=\"text-2xl font-bold text-blue-900\" id=\"testDuration\">0s</div>\n                                <p class=\"text-sm text-blue-700\">\u23F1\uFE0F Dur\u00E9e</p>\n                            </div>\n                            <div class=\"bg-green-50 rounded-lg p-4 border border-green-200\">\n                                <div class=\"text-2xl font-bold text-green-900\" id=\"testTracking\">0%</div>\n                                <p class=\"text-sm text-green-700\">\uD83D\uDC41\uFE0F Suivi</p>\n                            </div>\n                            <div class=\"bg-orange-50 rounded-lg p-4 border border-orange-200\">\n                                <div class=\"text-2xl font-bold text-orange-900\" id=\"testFixations\">0</div>\n                                <p class=\"text-sm text-orange-700\">\uD83C\uDFAF Fixations</p>\n                            </div>\n                            <div class=\"bg-purple-50 rounded-lg p-4 border border-purple-200\">\n                                <div class=\"text-2xl font-bold text-purple-900\" id=\"testEyeState\">\u25CF\u25CF</div>\n                                <p class=\"text-sm text-purple-700\">\uD83D\uDC40 Yeux</p>\n                            </div>\n                            <div class=\"bg-cyan-50 rounded-lg p-4 border border-cyan-200\">\n                                <div class=\"text-2xl font-bold text-cyan-900\" id=\"testStability\">--</div>\n                                <p class=\"text-sm text-cyan-700\">\uD83D\uDCCA Stabilit\u00E9</p>\n                            </div>\n                            <div class=\"bg-pink-50 rounded-lg p-4 border border-pink-200\">\n                                <div class=\"text-2xl font-bold text-pink-900\" id=\"testConfidence\">--</div>\n                                <p class=\"text-sm text-pink-700\">\uD83C\uDFAF Confiance</p>\n                            </div>\n                        </div>\n                        `\n                        : ''\n                }\n\n                <div class=\"flex gap-4\">\n                    ${\n                        !testActive\n                            ? `\n                            <button class=\"px-8 py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg transition-colors\"\n                                onclick=\"window.app?.startTest?.()\" ${!state.isCalibrated ? 'disabled opacity-50' : ''}>\n                                \u25B6\uFE0F D\u00E9marrer le test\n                            </button>\n                            `\n                            : `\n                            <button class=\"px-8 py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg transition-colors\"\n                                onclick=\"window.app?.stopTest?.()\">\n                                \u23F9\uFE0F Arr\u00EAter le test\n                            </button>\n                            `\n                    }\n                    <button class=\"px-8 py-3 bg-gray-300 hover:bg-gray-400 text-gray-900 font-bold rounded-lg transition-colors\"\n                        onclick=\"window.app?.goToScreen?.('home-screen')\">\n                        \u2190 Retour\n                    </button>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\nfunction renderResultsScreen(): string {\n    const state = stateManager.getState();\n    const tests = state.testResults || [];\n\n    return `\n        <div class=\"max-w-5xl mx-auto\">\n            <div class=\"bg-white rounded-lg shadow-md p-8\">\n                <h2 class=\"text-2xl font-bold text-gray-900 mb-6\">R\u00E9sultats des Tests</h2>\n\n                ${\n                    tests.length === 0\n                        ? `\n                        <div class=\"text-center py-12\">\n                            <p class=\"text-gray-600 text-lg\">Aucun test effectu\u00E9</p>\n                            <button class=\"mt-4 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors\"\n                                onclick=\"window.app.goToScreen('test-screen')\">\n                                Effectuer un test\n                            </button>\n                        </div>\n                        `\n                        : `\n                        <div class=\"space-y-4\">\n                            ${tests\n                                .map(\n                                    (test: any, idx: number) => `\n                                <div class=\"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow\">\n                                    <div class=\"flex justify-between items-start mb-2\">\n                                        <div>\n                                            <h3 class=\"font-bold text-gray-900\">Test ${tests.length - idx}</h3>\n                                            <p class=\"text-sm text-gray-600\">${new Date(test.startTime).toLocaleString()}</p>\n                                        </div>\n                                        <span class=\"px-3 py-1 rounded-full text-sm font-medium ${\n                                            test.result === 'excellent'\n                                                ? 'bg-green-100 text-green-800'\n                                                : test.result === 'good'\n                                                ? 'bg-blue-100 text-blue-800'\n                                                : 'bg-orange-100 text-orange-800'\n                                        }\">\n                                            ${test.result || 'En attente'}\n                                        </span>\n                                    </div>\n                                    <div class=\"grid grid-cols-3 gap-4 text-sm\">\n                                        <div>\n                                            <p class=\"text-gray-600\">Dur\u00E9e</p>\n                                            <p class=\"font-bold text-gray-900\">${test.totalTime?.toFixed(1) || 0}s</p>\n                                        </div>\n                                        <div>\n                                            <p class=\"text-gray-600\">Suivi</p>\n                                            <p class=\"font-bold text-gray-900\">${test.trackingPercentage || 0}%</p>\n                                        </div>\n                                        <div>\n                                            <p class=\"text-gray-600\">Fixations</p>\n                                            <p class=\"font-bold text-gray-900\">${test.fixationCount || 0}</p>\n                                        </div>\n                                    </div>\n                                </div>\n                            `\n                                )\n                                .join('')}\n                        </div>\n                        `\n                }\n\n                <div class=\"mt-8 flex gap-4\">\n                    <button class=\"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition-colors\"\n                        onclick=\"window.app.goToScreen('test-screen')\">\n                        Nouveau test\n                    </button>\n                    <button class=\"px-6 py-3 bg-gray-300 hover:bg-gray-400 text-gray-900 font-bold rounded-lg transition-colors\"\n                        onclick=\"window.app.goToScreen('home-screen')\">\n                        \u2190 Accueil\n                    </button>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\nfunction renderRegisterScreen(): string {\n    return `\n        <div class=\"max-w-md mx-auto\">\n            <div class=\"bg-white rounded-lg shadow-md p-8\">\n                <h2 class=\"text-2xl font-bold text-gray-900 mb-6\">Inscription Patient</h2>\n                \n                <form id=\"registerForm\" class=\"space-y-4\">\n                    <div>\n                        <label class=\"block text-sm font-medium text-gray-700 mb-1\">Nom d'utilisateur</label>\n                        <input type=\"text\" id=\"registerUsername\" placeholder=\"Votre nom d'utilisateur\" required\n                            class=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" />\n                    </div>\n                    \n                    <div>\n                        <label class=\"block text-sm font-medium text-gray-700 mb-1\">Email</label>\n                        <input type=\"email\" id=\"registerEmail\" placeholder=\"votre.email@example.com\" required\n                            class=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" />\n                    </div>\n                    \n                    <div>\n                        <label class=\"block text-sm font-medium text-gray-700 mb-1\">Pr\u00E9nom</label>\n                        <input type=\"text\" id=\"registerFirstName\" placeholder=\"Votre pr\u00E9nom\" required\n                            class=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" />\n                    </div>\n                    \n                    <div>\n                        <label class=\"block text-sm font-medium text-gray-700 mb-1\">Nom</label>\n                        <input type=\"text\" id=\"registerLastName\" placeholder=\"Votre nom\" required\n                            class=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" />\n                    </div>\n                    \n                    <div>\n                        <label class=\"block text-sm font-medium text-gray-700 mb-1\">\u00C2ge</label>\n                        <input type=\"number\" id=\"registerAge\" placeholder=\"Votre \u00E2ge\" min=\"1\" max=\"120\" required\n                            class=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" />\n                    </div>\n                    \n                    <div>\n                        <label class=\"block text-sm font-medium text-gray-700 mb-1\">Mot de passe</label>\n                        <input type=\"password\" id=\"registerPassword\" placeholder=\"Votre mot de passe\" required\n                            class=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" />\n                    </div>\n                    \n                    <div>\n                        <label class=\"block text-sm font-medium text-gray-700 mb-1\">Confirmer le mot de passe</label>\n                        <input type=\"password\" id=\"registerPasswordConfirm\" placeholder=\"Confirmer votre mot de passe\" required\n                            class=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" />\n                    </div>\n                    \n                    <button type=\"submit\" class=\"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition-colors\">\n                        S'inscrire\n                    </button>\n                </form>\n                \n                <p class=\"text-center text-gray-600 mt-4\">\n                    D\u00E9j\u00E0 inscrit? <button class=\"text-blue-600 hover:underline font-medium\" onclick=\"window.app.goToScreen('home-screen')\">Se connecter</button>\n                </p>\n            </div>\n        </div>\n    `;\n}\n\nfunction renderStatisticsScreen(): string {\n    const state = stateManager.getState();\n    const tests: any[] = state.testResults || [];\n\n    // Calculer les statistiques\n    const totalTests = tests.length;\n    const excellentCount = tests.filter((t: any) => t.result === 'excellent').length;\n    const goodCount = tests.filter((t: any) => t.result === 'good').length;\n    const acceptableCount = tests.filter((t: any) => t.result === 'acceptable').length;\n    const poorCount = tests.filter((t: any) => t.result === 'poor').length;\n\n    const avgTracking = totalTests > 0 ? tests.reduce((sum: number, t: any) => sum + (t.trackingPercentage || 0), 0) / totalTests : 0;\n    const avgStability = totalTests > 0 ? tests.reduce((sum: number, t: any) => sum + (t.gazeStability || 0), 0) / totalTests : 0;\n\n    return `\n        <div class=\"max-w-4xl mx-auto\">\n            <div class=\"bg-white rounded-lg shadow-md p-8\">\n                <h2 class=\"text-2xl font-bold text-gray-900 mb-6\">Statistiques Globales</h2>\n\n                ${\n                    totalTests === 0\n                        ? `\n                        <div class=\"text-center py-12\">\n                            <p class=\"text-gray-600 text-lg\">Aucune donn\u00E9e disponible</p>\n                            <p class=\"text-gray-500 text-sm mt-2\">Effectuez des tests pour voir les statistiques</p>\n                        </div>\n                        `\n                        : `\n                        <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n                            <div class=\"bg-green-50 rounded-lg p-6 border border-green-200\">\n                                <div class=\"text-3xl font-bold text-green-900\">${excellentCount}</div>\n                                <p class=\"text-sm text-green-700\">Excellent</p>\n                            </div>\n                            <div class=\"bg-blue-50 rounded-lg p-6 border border-blue-200\">\n                                <div class=\"text-3xl font-bold text-blue-900\">${goodCount}</div>\n                                <p class=\"text-sm text-blue-700\">Bon</p>\n                            </div>\n                            <div class=\"bg-yellow-50 rounded-lg p-6 border border-yellow-200\">\n                                <div class=\"text-3xl font-bold text-yellow-900\">${acceptableCount}</div>\n                                <p class=\"text-sm text-yellow-700\">Acceptable</p>\n                            </div>\n                            <div class=\"bg-red-50 rounded-lg p-6 border border-red-200\">\n                                <div class=\"text-3xl font-bold text-red-900\">${poorCount}</div>\n                                <p class=\"text-sm text-red-700\">Faible</p>\n                            </div>\n                        </div>\n\n                        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\n                            <div class=\"bg-gray-50 rounded-lg p-6 border border-gray-200\">\n                                <div class=\"text-2xl font-bold text-gray-900\">${avgTracking.toFixed(1)}%</div>\n                                <p class=\"text-sm text-gray-700\">Suivi moyen</p>\n                            </div>\n                            <div class=\"bg-gray-50 rounded-lg p-6 border border-gray-200\">\n                                <div class=\"text-2xl font-bold text-gray-900\">${avgStability.toFixed(1)}%</div>\n                                <p class=\"text-sm text-gray-700\">Stabilit\u00E9 moyenne</p>\n                            </div>\n                        </div>\n\n                        <div class=\"bg-gray-50 rounded-lg p-6 border border-gray-200\">\n                            <h3 class=\"text-lg font-bold text-gray-900 mb-4\">\u00C9volution des performances</h3>\n                            <div class=\"text-sm text-gray-600\">\n                                <p>Total des tests: <strong>${totalTests}</strong></p>\n                                <p>Taux de succ\u00E8s: <strong>${((excellentCount + goodCount) / totalTests * 100).toFixed(1)}%</strong></p>\n                            </div>\n                        </div>\n                        `\n                }\n\n                <div class=\"mt-8 flex gap-4\">\n                    <button class=\"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition-colors\"\n                        onclick=\"window.app.goToScreen('test-screen')\">\n                        Nouveau test\n                    </button>\n                    <button class=\"px-6 py-3 bg-gray-300 hover:bg-gray-400 text-gray-900 font-bold rounded-lg transition-colors\"\n                        onclick=\"window.app.goToScreen('home-screen')\">\n                        \u2190 Accueil\n                    </button>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n// Export des fonctions\nexport {\n    renderHomeScreen,\n    renderCalibrationScreen,\n    renderTestScreen,\n    renderResultsScreen,\n    renderRegisterScreen,\n    renderStatisticsScreen\n};\n"],
  "mappings": "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",
  "names": ["leftOpen", "rightOpen", "window", "pointElement", "app"]
}
